<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"/>
<title>Google Maps API v3 for GEE 5.x</title>
<link rel="stylesheet" href="../css/styles.css" type="text/css" media="all" />
<link rel="stylesheet" href="../css/containers.css" type="text/css" media="all" />
</head>
<body>
<!-- 6078457.html -->
<div class="container">
  <div class="sidebar1">
<p class="sidebar-toc"><a href="../answer/6078457.html" class="current-file">Google Maps API v3 for GEE 5.x</a></p>
<p class="sidebar-toc"><a href="../answer/6014171.html">Add Python libraries to GEE Python</a></p>
  </div>
  <div class="content">
<a name="top_of_file"></a>
<p><img src="../art/common/logo_col_126x48.png" width="126" height="48" alt="Google logo" /></p>
<h1><a href="../answer/index.html">Google Earth Enterprise Documentation Home</a> | Developers</h1>
<h2>Google Maps API v3 for GEE 5.x</h2><ul>
  <li><a href="#Overview">Overview</a></li>
  <li><a href="#How">How <code>geeCreateFusionMap</code> works</a></li>
  <li><a href="#Factory"><code>geeCreateFusionMap</code> Factory</a></li>
  <li><a href="#Methods"><code>google.maps.Map</code> Method extensions</a></li>
  <li><a href="#Examples">Examples</a></li>
</ul>

<div class="tip">
For GEE release 4.4, see <a href="https://support.google.com/earthenterprise/answer/6008871">Google Maps API v3 for GEE 4.4</a>.
</div>

<h3><a id="Overview">Overview</a></h3>
<p>The <a href="https://developers.google.com/maps/documentation/javascript/">Google Maps Javascript API V3</a> is bundled with Google Earth Enterprise (GEE) Server and, for offline use, with Portable Server.  As of June 2014 Google Maps JavaScript API v3.16 is bundled with GEE v5.x, but the API is updated periodically to align with the Release version.</p>

<p>The bundled offline Google Maps JavaScript API is the same core Javascript V3 API supporting:</p>
<ul>
  <li><strong>Events</strong>: Listening to click, mouseover</li>
  <li><strong>Controls</strong>: Built-in zoom, pan, scale + custom controls</li>
  <li><strong>Overlays</strong>: Symbols, markers, polylines</li>
</ul>

<p>However there are some differences:</p>
<ul>
  <li>Method of invoking the API from a GEE or Portable Server to load in a web page.</li>
  <li><code>geeCreateFusionMap</code> is a factory used to create instances of the <code>google.maps.Map</code> class. </li>
  <li>No support for objects that require access to online Google services:
    <ul>
      <li>Geocoding (<code>google.maps.Geocoder</code>)</li>
      <li>Directions (<code>google.maps.Directions</code>)</li>
      <li>StreetView (<code>google.maps.StreetViewPanorama</code>)</li>
      <li>Traffic (<code>google.maps.TrafficLayer</code>)</li>
      <li>Places API, Distance Matrix, Wikipedia, Panaramio, Weather layer, etc.</li>
    </ul>
  </li>
</ul>

<h3>Using the Fusion Maps API</h3>
<p>The Fusion Maps API is used to create and interact with map layers created in Google Earth Enterprise. The API is based on the Google Maps API but includes <code>geeCreateFusionMap</code>, which makes it easier to interact with map layers generated by Google Earth Enterprise. Essentially, <code>geeCreateFusionMap</code> is a factory used to create instances of the <code>google.maps.Map</code> class in which the GEE-specific configuration options can be added as Method extensions.</p>

<p>The following code snippet shows how <code>geeCreateFusionMap</code> is used to load a map:</p>
<pre>
&lt;html&gt;

  // Start by defining GEE_BASE_URL.
  &lt;script type="text/javascript"&gt;
    var GEE_BASE_URL = window.location.protocol + '//' + window.location.host;
  &lt;/script&gt;

  // Include the provided Maps API v3 files.  Located in /opt/google/gehttpd/htdocs/maps/api/
  &lt;script type="text/javascript" src="/maps/api/bootstrap.js"&gt;&lt;/script&gt;
  &lt;script type="text/javascript" src="/maps/api/fusion_extended_map.js"&gt;&lt;/script&gt;

  // geeServerDefs must be defined with the following script.
  &lt;script type="text/javascript" src="http://yourhost.com/YourPublishedDatabase/query?request=Json&amp;var=geeServerDefs"&gt;&lt;/script&gt;

  &lt;script type="text/javascript"&gt;
    // Using the geeServerDefs defined above, create a map instance.
    var geemap = new geeCreateFusionMap("map_canvas", geeServerDefs, myOptions);
  &lt;/script&gt;

  &lt;/head&gt;
  &lt;body onload="initialize()"&gt;
    // Be sure there is an element on the page with the id you specified above (map_canvas in this case).
    &lt;div id="map_canvas" style="width:100%; height:100%"&gt;&lt;/div&gt;
  &lt;/body&gt;

&lt;/html&gt;
</pre>

<h4><a id="How">Factory geeCreateFusionMap</a></h4>
<p>Use of the factory <code>geeCreateFusionMap</code> is distinct from the standard Google Maps JavaScript API usage in the following ways:

<ul>
  <li>Instantiate <code>geeCreateFusionMap</code> in order to create a Fusion map. This is a factory for an extended version of the Maps API v3 <code>google.maps.Map</code> class, and the other methods are the extensions to that class.</li>
  <li>Use <code>geeCreateFusionMap</code> class instead of <code>google.maps.Map</code> to create applications that use layers from GME or GEE.</li>
  <li><code>geeCreateFusionMap(container, opts?)</code> creates a new map inside the given HTML container, typically a <code>DIV</code> element. Options are the same as those of <code>google.maps.Map</code></li>
  <li>If a map type is passed into the options, GEE Server will override these if an imagery layer is included in the Fusion Maps Database.</li>
  <li>The path and location of the new map is <code>serverURL/default_map</code>, for example, <em>http://my_host_name/default_map</em>.</li>
</ul>


<h3>Factory geeCreateFusionMap Description</h3>
<p>The <code>Factory</code> and <code>Method extensions</code> are described in the following tables.</p>

<h3><a id="Factory">Factory</a></h3>
<div>
<table class="nice-table">
  <tbody>
  <tr>
  <th>Factoryclass</th>
  <th>Description</th>
  </tr>
  <tr>
  <td><code>geeCreateFusionMap(container, opts?)</code></td>
  <td>Creates a new Fusion map inside of the given HTML container, which is typically a <code>DIV</code> element. The options are the same as the options for <code>google.maps.Map</code>. However, if a map type is passed in to the options, the Fusion maps server will override these if an imagery layer is included in the Fusion Maps Database. After this constructor is invoked, the <code>setCenter()</code> method should be called before any methods that display Fusion layers on top of the map.</td>
  </tr>
  </tbody>
</table>
</div>

<h3><a id="Methods">Method extensions</a></h3>
<p><code>geeCreateFusionMap</code> Method extensions are extensions of the Google Maps API v3 <code>google.maps.Map</code> class.</p>

<div>
<table class="nice-table">
  <tbody>
  <tr>
  <th>Method extensions</th>
  <th>Return Value</th>
  <th>Description</th>
  </tr>
  <tr>
  <td><code>showInitialFusionLayers()</code></td>
  <td>None</td>
  <td>Show all layers that are enabled by default. This method should only be invoked after the <code>setCenter()</code method has been called to initially draw the map.</td>
  </tr>
  <tr>
  <td><code>getFusionLayerCount()</code></td>
  <td>Number</td>
  <td>Returns the number of Fusion map layers. This does not include the base imagery layer, which is built as a custom map type and serves as the background of the map.</td>
  </tr>
  <tr>
  <td><code>isFusionLayerVisible(index)</code></td>
  <td>Boolean</td>
  <td>Returns true if the layer is currently shown on the map and false if it is hidden.</td>
  </tr>
  <tr>
  <td><code>showFusionLayer(index)</code></td>
  <td>None</td>
  <td>Shows a previously hidden Fusion map layer. This method should only be invoked after the <code>setCenter()</code> method has been called to initially draw the map.</td>
  </tr>
  <tr>
  <td><code>hideFusionLayer(index)</code></td>
  <td>None</td>
  <td>Hides the specified Fusion map layer.</td>
  </tr>
  <tr>
  <td><code>getFusionLayerName(index)</code></td>
  <td>String</td>
  <td>Returns the name of the specified layer.</td>
  </tr>
  <tr>
  <td><code>getFusionLayerIcon(index)</code></td>
  <td>String</td>
  <td>Returns the URL of the icon associated with the specified layer.</td>
  </tr>
  </tbody>
</table>
</div>

<h3><a id="Examples">Examples</a></h3>
<p>Several examples that illustrate how to use the Fusion Maps API are installed by default. You can find these examples in:</p>

<p><code>/opt/google/gehttpd/htdocs/maps</code></p>


<p>The following files are used by default for a published database.  For example, when serving <code>http://your-host.com/YourPublishedDatabase</code>, this code is used to render the page.</p>
<ul>
  <li><code>maps_local.html</code></li>
  <li><code>maps_google.html</code></li>
</ul>

<p>The following files provide basic examples of initializing a Fusion Map.  You can use them as templates but you'll need to edit them with the target path of a published 2D database to correctly initialize a map in the browser.</p>
<ul>
  <li><code>example_google.html</code></li>
  <li><code>example_local.html</code></li>
</ul>



   </div>
  <div class="footer">
  <p class="BackToTop"><a href="#top_of_file">Back to top</a>
  <hr />
  <p class="copyright">For the latest version of this documentation, go to the <a href="http://support.google.com/earthenterprise" target="_blank">Google Earth Enterprise help center</a>.<br />&copy;2014 Google</p>
  </div>
</div>
</body>
</html>
