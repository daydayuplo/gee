<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">









 


   
  
  


<html>
  <head>
    <script type="text/javascript" language="JavaScript">
    ORIGINAL_PAGE_PATH = "/apis/earth/documentation/events.html";
    </script>
    
    
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>Events - Google Earth API - Google Code</title>
<script type="text/javascript"><!--
(function(){function a(){this.t={};this.tick=function(c){this.t[c]=(new Date).getTime()};this.tick("start")}var b=new a;window.jstiming={Timer:a,load:b};if(window.external&&window.external.pageT)window.jstiming.pt=window.external.pageT;})();

var _tocPath_ = '/apis/earth/documentation/_toc.ezt';
var codesite_token = null;
var logged_in_user_email = null;
//--></script>
<link href="../../../css/codesite.pack.04102009.css" type="text/css" rel="stylesheet">
<script src="../../../js/codesite_head.pack.04102009.js" type="text/javascript"></script>
<script type="text/javascript">CODESITE_CSITimer['load'].tick('bhs');</script>
<link rel="search" type="application/opensearchdescription+xml" title="Google Code" href="http://code.google.com/osd.xml">

<!--[if IE]><link rel="stylesheet" type="text/css" href="../../../css/iehacks.css"><![endif]-->

    <link href="../../../css/semantic_headers.css" rel="stylesheet" type="text/css" />
       <script src="addCommentsToToc.js" type="text/javascript"></script>
  </head>

  <body class="gc-documentation">

    
    
    <div id="gb">
 <span>
  
    <a id="lang-dropdown" class="dropdown" href="http://code.google.com" onclick="return false;"><img width="13" height="13" class="globeicon" src="../../../images/globe2_small.png"
     ><span style="text-decoration:underline">English</span> <span style="font-size:.75em;">&#9660;</span></a>
  
 </span>
</div>

<div class="gbh" style="left:0px;"></div>
<div class="gbh" style="right:0px;"></div>

<div id="gc-container">
<a id="top"></a>
<div id="skipto">
  <a href="#gc-pagecontent">Skip to page content</a>
  <a href="#gc-toc">Skip to main navigation</a>
</div>

<div id="gc-header">
  <div id="logo"><a href="http://code.google.com">
  
  
     <img src="../../../images/code_logo.png" height="40" width="161" alt="Google Code" style="border:0;margin:3px 0 0 0;">
  
  
  </a></div>
  <div id="search">
    <div id="searchForm" class="searchForm">
      <form id="cse" action="http://www.google.com/cse" accept-charset="utf-8" class="gsc-search-box" onsubmit="executeGSearch(document.getElementById('gsearchInput').value); return false;">
      <noscript>
      <input type="hidden" name="cref" value="http://code.google.com/cse/googlecode-context.xml">
      </noscript>
      <div id="gsc-search-box">
        <input id="gsearchInput" type="text" name="q" maxlength="2048" class="gsc-input" autocomplete="off" title="Google Code Search" style="width:345px">
        <div id="cs-searchresults" onclick="event.cancelBubble = true;"></div>
        <input title="Search" id="gsearchButton" class="gsc-search-button" name="sa" value="Search" type="submit">
        <div class="greytext">e.g. "ajax apis" or "open source"</div>
      </div>
      </form>
    </div> <!-- end searchForm -->
  </div> <!-- end search -->



<h2 id="googlecode-promo">Make web development faster with these <a href="http://chrome.google.com/extensions/featured/web_dev" onclick="siteTracker._trackEvent('Promos','Web Development',this.href);">Chrome Extensions</a>!</h2>

</div> <!-- end gc-header -->


<div id="codesiteContent">

<a id="gc-topnav-anchor"></a>
<div id="gc-topnav">
  <h1 style="padding:0 0 0 6px;">Google Earth API</h1>
  <ul id="docs" class="gc-topnav-tabs">

    <li id="home_link">
      <a href="../index.html" title="Google Earth API home page">Home</a>
    </li>
  
    <li id="docs_link">
      <a href="index.html" class="selected" title="Official Google Earth API documentation">Docs</a>
    </li>
  
    <li id="faq_link">
      <a href="../faq.html" title="Answers to frequently asked questions about Google Earth API">FAQ</a>
    </li>
  
    <li id="articles_link">
      <a href="../articles/index.html" title="Focused articles and tutorials for Google Earth API developers">Articles</a>
    </li>
  
    <li>
      <a href="http://googlegeodevelopers.blogspot.com/" title="Official Google Earth API blog">Blog</a>
    </li>
  
    <li>
      <a href="http://groups.google.com/group/google-earth-browser-plugin/topics" title="Google Earth API developer forum">Forum</a>
    </li>
  
    <li>
      <a href="http://code.google.com/apis/maps/terms.html" title="Google Earth API terms of service">Terms</a>
    </li>
  

  </ul>
</div> <!-- end gc-topnav -->

    <div class="g-section g-tpl-170">

      <div class="g-unit g-first" id="gc-toc">
        <ul>
  <li><a href="http://code.google.com/apis/maps/signup.html">Sign up for a Maps API key</a></li>
</ul>

<div class="line"></div>

<ul>

  <li>
    <h2><a href="reference/#">API Reference</a></h2>
    <div class="line"></div>
  </li>
  <li><h2>Developer's Guide</h2>
    <ul>
      <li><a href="index.html">Introduction</a></li>
      <li><a href="placemarks.html">Placemarks</a></li>
      <li><a href="balloons.html">Balloons</a></li>
      <li><a href="geometries.html">Geometries & Overlays</a></li>
      <li><a href="camera_control.html">Camera Control</a></li>
      <li><a href="layers.html">Layers & Controls</a></li>
      <li><a href="time.html">Time</a> <sup class="new">Updated</sup></li>
      <li><a href="ocean.html">Ocean</a></li>
      <li><a href="sky_mars_moon.html">Sky, Mars, & Moon</a></li>
      <li><a href="touring.html">Touring</a></li>
      <li><a href="events.html">Events</a></li>
      <li><a href="accessors.html">Accessors</a> <sup class="new">New!</sup></li>
      <li><a href="containers.html">Object Containers</a></li>
      <li><a href="kml.html">KML</a></li>
      <li><a href="options.html">Options</a></li>
      <li><a href="debugging.html">Debugging</a></li>
    </ul>
  </li>
        
  <div class="line"></div>
    
  <li><h2 class="tlw-expanded">Code Samples</h2>
    <ul>
      <li><a href="examples.html">Examples</a></li>
      <li><a href="demogallery.html">Demo Gallery</a>
      </li>
      <li><a href="http://code.google.com/apis/ajax/playground/?exp=earth">Code Playground</a></li>
    </ul>
  </li>
    
  <div class="line"></div>
    
  <li><h2 class="tlw-expanded">More Resources</h2>
    <ul>
      <li><a href="mediagallery.html">Media</a></li>
      <li><a href="releasenotes.html">Release Notes</a></li>
      <li><a href="http://code.google.com/p/earth-api-utility-library">Utility Library</a></li>
      <li><a href="http://code.google.com/p/earth-api-samples/issues/list?q=label%3AType-Defect">Known Issues</a></li>
    </ul>
  </li>
</ul>

<div class="line"></div>
<ul>
 <li>
    <h2>Related Docs</h2>
    <ul>                
      <li><a href="http://code.google.com/apis/kml/documentation/index.html">KML</a></li>
      <li><a href="http://code.google.com/apis/maps/documentation/index.html">Maps API</a></li>
    </ul>                
 </li>
</ul>
        <a class="hidden" href="#gc-topnav-anchor">More Google Earth API resource links</a>
      </div>

      <div class="g-unit" id="gc-pagecontent">
        <script type="text/javascript">CODESITE_docEarlyProcessing();</script>


        <h1 class="page_title">Events</h1>



<div class="toc">
<ol>
   <li><a href="#intro">Introduction</a></li>
   <li><a href="#event_listeners">Event listeners</a></li>
   <li><a href="#removing_event_listeners">Removing event listeners</a>
   <li><a href="#dom_events">DOM events</a></li>
   <li><a href="#examples">Examples</a></li>
</ol>
</div>

<h2><a name="intro"></a>Introduction</h2>

<p>The Google Earth API provides a number of different events, which can be used
   with <code>google.earth.addEventListener</code> to provide additional interactivity in
   your applications. Using event listeners, you can create actions that are triggered
   on mouse events (such as clicks, movement, or dragging) or screen events
   (such as changes to the view).</p>
<p>Adding an Earth API event listener requires three arguments, and accepts an optional fourth:
   the object on which to add the listener, the event to listen for, the function
   to call when the event is fired, and (optionally) whether or not this listener
   should initiate capture (refer to the relevant <a href="http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-flow-capture">W3C DOM documentation</a> for details of event capture). The default value for this fourth argument is <code>false</code>.</p>
<pre class="prettyprint">google.earth.addEventListener(placemark10, 'click', doSomething);</pre>
<p><code>addEventListener()</code> and <code>removeEventListener()</code> live in the <code>google.earth</code> namespace.</p>

<h2 id="event_listeners">Event listeners</h2>
<p><em>Mouse events</em> can be attached to most geometries in the plugin (the exception is
   3D models), to the entire viewport, or to the globe only. There are listeners
   for most mouse events, including clicks
   and movements. For a full list of mouse events, refer to the <a href="reference/interface_g_e_event_emitter.html">GEEventEmitter
   Interface Reference</a>.</p>
<p><em>View events</em> are fired when the view begins to change, while
   it is changing, and when it has ended . Listeners
   for view events must be attached to the viewport object of the plugin instance
   (<code>ge.getView()</code>). <code>viewchangeend</code> may fire in the middle of a view change, if the
   plugin pauses for a brief period during the change. If you are relying on <code>viewchangeend</code>
   to indicate the absolute end of a view change, it's recommended that you include
   a brief timeout to ensure that no further view changes are to follow:</p>
<pre class="prettyprint">google.earth.addEventListener(ge.getView(), 'viewchangeend', setTimeout(eventHandler, 100));</pre>
<p>For a full list of view events, refer to the <a href="reference/interface_g_e_view.html">GEView
      Interface Reference</a>.</p>
<p>A <code>frameend</code> event is fired when Earth has finished rendering the viewport. This
   event will be called many times in succession when the viewport is changing. Add
   a listener for this event and make incremental changes to the viewport for smooth
   animation. A <code>frameend</code> listener must be attached to the Google Earth
   Plugin instance.</p>
<p>The <code>balloonclose</code> event is fired when the current description balloon
   is closed. Its listener must be attached to the plugin instance.</p>
<h2 id="removing_event_listeners">Removing event listeners</h2>
<p>You can remove event listeners using <code>removeEventListener()</code>. You must pass the same object, event type, and function name to <code>removeEventListener()</code> as
   were specified when creating the event listener. </p>
<pre class="prettyprint">
var eventHandler = function(){ ... }; 

// Add an event listener
google.earth.addEventListener(ge.getGlobe(), 'mousemove', eventHandler);
// Remove this event listener
google.earth.removeEventListener(ge.getGlobe(), 'mousemove', eventHandler);
</pre>

<h2 id="dom_events">DOM events</h2>
<p>To add listeners to HTML elements on the page, outside of the plugin, you can use this helper
function that will work across all modern browsers:</p>

<pre class="prettyprint">
function addDomListener(element, eventName, listener) {
   if (element.addEventListener) // most browsers
      element.addEventListener(eventName, listener, false);
   else if (element.attachEvent) // IE
      element.attachEvent('on' + eventName, listener);
</pre>

<p>This accounts for the different methods of attaching handlers in Internet Explorer
   and most other browsers; IE uses <code>attachEvent</code> and <code>onclick</code>, while others use <code>addEventListener</code> and <code>click</code>.</p>
<h2 id="examples">Examples</h2>
<h3>mousemove</h3>
<p>The following example adds an event listener to the globe object to listen for
   mousemove events.</p>
<p><strong>Source</strong>: <a href="samples/mousemove_listener_example.html">http://code.google.com/apis/earth/documentation/samples/mousemove_listener_example.html</a></p>
<pre class="prettyprint">ge = instance;
ge.getWindow().setVisibility(true);

// Define what happens when a mousemove is detected on the globe.
var maxAlt = -1000000;
function recordAltitude(event) {
   var currentAlt = event.getAltitude();
   maxAlt = Math.max(maxAlt, currentAlt);
   document.getElementById('altitude').innerHTML = 
      '&lt;p&gt;Current altitude: ' + currentAlt + '&lt;br /&gt;Max altitude: ' 
      + maxAlt + '&lt;/p&gt;';
}

// Listen to the mousemove event on the globe.
google.earth.addEventListener(ge.getGlobe(), 'mousemove', recordAltitude);
</pre>

<h3>Draggable placemark</h3>
<p>The following example comes from <strong>earth-api-samples.googlecode.com</strong>.
   It uses three event listeners: </p>
<ul>
   <li>the first listens for <code>mousedown</code> events anywhere in the window. If the target of
      the mousedown event is a point placemark, <code>dragInfo</code> is set to true.</li>
   <li>the second listens for <code>mousemove</code> events anywhere on the globe. If <code>dragInfo</code> is
      true, the latitude and longitude of the point placemark is updated as the mouse
      is moved.</li>
   <li>the last listener listens for <code>mouseup</code> events. It prevents any feature balloons
      from popping when the mouse button is released, and sets <code>dragInfo</code> to <code>null</code> so that
      the placemark's longitude and latitude are no longer updated.</li>
</ul>
<p><strong>Source</strong>: <a href="http://earth-api-samples.googlecode.com/svn/trunk/examples/placemark-dragdrop.html"> http://earth-api-samples.googlecode.com/svn/trunk/examples/placemark-dragdrop.html </a></p>
<pre class="prettyprint">
var ge;
var placemark;
var dragInfo = null;

google.load(&quot;earth&quot;, &quot;1&quot;);

function init() {
  google.earth.createInstance('map3d', initCallback, failureCallback);
}

function initCallback(instance) {
  ge = instance;
  ge.getWindow().setVisibility(true);

  // Create the placemark and add it to Earth.
  placemark = ge.createPlacemark('');
  var point = ge.createPoint('');
  point.setLatitude(37);
  point.setLongitude(-122);
  placemark.setGeometry(point);
  placemark.setName('Drag Me!');
  ge.getFeatures().appendChild(placemark);

  // Look at the placemark we created.
  var la = ge.createLookAt('');
  la.set(37, -122, 0, ge.ALTITUDE_RELATIVE_TO_GROUND, 0, 0, 5000);
  ge.getView().setAbstractView(la);

  // Listen for mousedown on the window (look specifically for point placemarks).
  google.earth.addEventListener(ge.getWindow(), 'mousedown', function(event) {
    if (event.getTarget().getType() == 'KmlPlacemark' &&
        event.getTarget().getGeometry().getType() == 'KmlPoint') {
      var placemark = event.getTarget();
      dragInfo = {
        placemark: event.getTarget(),
        dragged: false
      };
    }
  });

  // Listen for mousemove on the globe.
  google.earth.addEventListener(ge.getGlobe(), 'mousemove', function(event) {
    if (dragInfo) {
      event.preventDefault();
      var point = dragInfo.placemark.getGeometry();
      point.setLatitude(event.getLatitude());
      point.setLongitude(event.getLongitude());
      dragInfo.dragged = true;
    }
  });

  // Listen for mouseup on the window.
  google.earth.addEventListener(ge.getWindow(), 'mouseup', function(event) {
    if (dragInfo) {
      if (dragInfo.dragged) {
        // If the placemark was dragged, prevent balloons from popping up.
        event.preventDefault();
      }

      dragInfo = null;
    }
  });

}

function failureCallback(errorCode) {
}
</pre>

<h3>Other examples</h3>
<p>There are a number of event listener examples in the <strong>earth-api-samples.googlecode.com</strong> project, including:</p>
<ul>
   <li><a href="http://earth-api-samples.googlecode.com/svn/trunk/examples/event-frameend.html">Smooth animation with frameend</a></li>
   <li><a href="http://earth-api-samples.googlecode.com/svn/trunk/examples/event-listeners.html">Toggling event listeners</a></li>
   <li><a href="http://earth-api-samples.googlecode.com/svn/trunk/examples/event-viewchange.html">viewchange events</a></li>
</ul>

 

      </div><!-- end gc-pagecontent -->
   </div><!-- end gooey wrapper -->

    </div> <!-- end codesite content -->


<div id="gc-footer" dir="ltr">
  <div class="text">
    
    &copy;2010 Google -
    <a href="http://code.google.com">Code Home</a> -
    <a href="http://code.google.com/terms.html">Terms of Service</a> -
    <a href="http://code.google.com/privacy.html">Privacy Policy</a> -
    <a href="http://code.google.com/more">Site Directory</a>
    <br> <br>
    Google Code offered in:
    <a href="http://code.google.com/intl/en">English</a> -
    <a href="http://code.google.com/intl/es">Español</a> -
    <a href="http://code.google.com/intl/ja">日本語</a> -
    <a href="http://code.google.com/intl/ko">한국어</a> -
    <a href="http://code.google.com/intl/pt-BR">Português</a> -
    <a href="http://code.google.com/intl/ru">Pусский</a> -
    <a href="http://code.google.com/intl/zh-CN">中文(简体)</a> -
    <a href="http://code.google.com/intl/zh-TW">中文(繁體)</a>
  </div>
</div><!-- end gc-footer -->

</div><!-- end gc-container -->

<script type="text/javascript">CODESITE_CSITimer['load'].tick('ats');</script>
<script src="../../../js/codesite_tail.pack.04102009.js" type="text/javascript"></script>




<script type="text/javascript">
var _gaq = _gaq || [];

_gaq.push(


    ['siteTracker._setAccount', 'UA-18071-1'],
    ['siteTracker._setDomainName', 'code.google.com'],
    ['siteTracker._setCookiePath', window.location.pathname.substring(0,
        window.location.pathname.lastIndexOf('/') + 1)],
    ['siteTracker._trackPageview']
);
(function() {
  var ga = document.createElement('script');

  ga.type = 'text/javascript';
  ga.async = true;
  ga.src = 'http://www.google-analytics.com/ga.js';
  (document.getElementsByTagName('head')[0] ||
   document.getElementsByTagName('body')[0]).appendChild(ga);
 })();
</script>




  </body>
</html>

