<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">









 


   
  
  


<html>
  <head>
    <script type="text/javascript" language="JavaScript">
    ORIGINAL_PAGE_PATH = "/apis/earth/documentation/kml.html";
    </script>
    
    
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>KML - Google Earth API - Google Code</title>
<script type="text/javascript"><!--
(function(){function a(){this.t={};this.tick=function(c){this.t[c]=(new Date).getTime()};this.tick("start")}var b=new a;window.jstiming={Timer:a,load:b};if(window.external&&window.external.pageT)window.jstiming.pt=window.external.pageT;})();

var _tocPath_ = '/apis/earth/documentation/_toc.ezt';
var codesite_token = null;
var logged_in_user_email = null;
//--></script>
<link href="../../../css/codesite.pack.04102009.css" type="text/css" rel="stylesheet">
<script src="../../../js/codesite_head.pack.04102009.js" type="text/javascript"></script>
<script type="text/javascript">CODESITE_CSITimer['load'].tick('bhs');</script>
<link rel="search" type="application/opensearchdescription+xml" title="Google Code" href="http://code.google.com/osd.xml">

<!--[if IE]><link rel="stylesheet" type="text/css" href="../../../css/iehacks.css"><![endif]-->

    <link href="../../../css/semantic_headers.css" rel="stylesheet" type="text/css" />
       <script src="addCommentsToToc.js" type="text/javascript"></script>
<style type="text/css">
.defs {margin-left:1.5em;}
</style>
  </head>

  <body class="gc-documentation">

    
    
    <div id="gb">
 <span>
  
    <a id="lang-dropdown" class="dropdown" href="http://code.google.com" onclick="return false;"><img width="13" height="13" class="globeicon" src="../../../images/globe2_small.png"
     ><span style="text-decoration:underline">English</span> <span style="font-size:.75em;">&#9660;</span></a>
  
 </span>
</div>

<div class="gbh" style="left:0px;"></div>
<div class="gbh" style="right:0px;"></div>

<div id="gc-container">
<a id="top"></a>
<div id="skipto">
  <a href="#gc-pagecontent">Skip to page content</a>
  <a href="#gc-toc">Skip to main navigation</a>
</div>

<div id="gc-header">
  <div id="logo"><a href="http://code.google.com">
  
  
     <img src="../../../images/code_logo.png" height="40" width="161" alt="Google Code" style="border:0;margin:3px 0 0 0;">
  
  
  </a></div>
  <div id="search">
    <div id="searchForm" class="searchForm">
      <form id="cse" action="http://www.google.com/cse" accept-charset="utf-8" class="gsc-search-box" onsubmit="executeGSearch(document.getElementById('gsearchInput').value); return false;">
      <noscript>
      <input type="hidden" name="cref" value="http://code.google.com/cse/googlecode-context.xml">
      </noscript>
      <div id="gsc-search-box">
        <input id="gsearchInput" type="text" name="q" maxlength="2048" class="gsc-input" autocomplete="off" title="Google Code Search" style="width:345px">
        <div id="cs-searchresults" onclick="event.cancelBubble = true;"></div>
        <input title="Search" id="gsearchButton" class="gsc-search-button" name="sa" value="Search" type="submit">
        <div class="greytext">e.g. "ajax apis" or "open source"</div>
      </div>
      </form>
    </div> <!-- end searchForm -->
  </div> <!-- end search -->



<h2 id="googlecode-promo">Make web development faster with these <a href="http://chrome.google.com/extensions/featured/web_dev" onclick="siteTracker._trackEvent('Promos','Web Development',this.href);">Chrome Extensions</a>!</h2>

</div> <!-- end gc-header -->


<div id="codesiteContent">

<a id="gc-topnav-anchor"></a>
<div id="gc-topnav">
  <h1 style="padding:0 0 0 6px;">Google Earth API</h1>
  <ul id="docs" class="gc-topnav-tabs">

    <li id="home_link">
      <a href="../index.html" title="Google Earth API home page">Home</a>
    </li>
  
    <li id="docs_link">
      <a href="index.html" class="selected" title="Official Google Earth API documentation">Docs</a>
    </li>
  
    <li id="faq_link">
      <a href="../faq.html" title="Answers to frequently asked questions about Google Earth API">FAQ</a>
    </li>
  
    <li id="articles_link">
      <a href="../articles/index.html" title="Focused articles and tutorials for Google Earth API developers">Articles</a>
    </li>
  
    <li>
      <a href="http://googlegeodevelopers.blogspot.com/" title="Official Google Earth API blog">Blog</a>
    </li>
  
    <li>
      <a href="http://groups.google.com/group/google-earth-browser-plugin/topics" title="Google Earth API developer forum">Forum</a>
    </li>
  
    <li>
      <a href="http://code.google.com/apis/maps/terms.html" title="Google Earth API terms of service">Terms</a>
    </li>
  

  </ul>
</div> <!-- end gc-topnav -->

    <div class="g-section g-tpl-170">

      <div class="g-unit g-first" id="gc-toc">
        <ul>
  <li><a href="http://code.google.com/apis/maps/signup.html">Sign up for a Maps API key</a></li>
</ul>

<div class="line"></div>

<ul>

  <li>
    <h2><a href="reference/#">API Reference</a></h2>
    <div class="line"></div>
  </li>
  <li><h2>Developer's Guide</h2>
    <ul>
      <li><a href="index.html">Introduction</a></li>
      <li><a href="placemarks.html">Placemarks</a></li>
      <li><a href="balloons.html">Balloons</a></li>
      <li><a href="geometries.html">Geometries & Overlays</a></li>
      <li><a href="camera_control.html">Camera Control</a></li>
      <li><a href="layers.html">Layers & Controls</a></li>
      <li><a href="time.html">Time</a> <sup class="new">Updated</sup></li>
      <li><a href="ocean.html">Ocean</a></li>
      <li><a href="sky_mars_moon.html">Sky, Mars, & Moon</a></li>
      <li><a href="touring.html">Touring</a></li>
      <li><a href="events.html">Events</a></li>
      <li><a href="accessors.html">Accessors</a> <sup class="new">New!</sup></li>
      <li><a href="containers.html">Object Containers</a></li>
      <li><a href="kml.html">KML</a></li>
      <li><a href="options.html">Options</a></li>
      <li><a href="debugging.html">Debugging</a></li>
    </ul>
  </li>
        
  <div class="line"></div>
    
  <li><h2 class="tlw-expanded">Code Samples</h2>
    <ul>
      <li><a href="examples.html">Examples</a></li>
      <li><a href="demogallery.html">Demo Gallery</a>
      </li>
      <li><a href="http://code.google.com/apis/ajax/playground/?exp=earth">Code Playground</a></li>
    </ul>
  </li>
    
  <div class="line"></div>
    
  <li><h2 class="tlw-expanded">More Resources</h2>
    <ul>
      <li><a href="mediagallery.html">Media</a></li>
      <li><a href="releasenotes.html">Release Notes</a></li>
      <li><a href="http://code.google.com/p/earth-api-utility-library">Utility Library</a></li>
      <li><a href="http://code.google.com/p/earth-api-samples/issues/list?q=label%3AType-Defect">Known Issues</a></li>
    </ul>
  </li>
</ul>

<div class="line"></div>
<ul>
 <li>
    <h2>Related Docs</h2>
    <ul>                
      <li><a href="http://code.google.com/apis/kml/documentation/index.html">KML</a></li>
      <li><a href="http://code.google.com/apis/maps/documentation/index.html">Maps API</a></li>
    </ul>                
 </li>
</ul>
        <a class="hidden" href="#gc-topnav-anchor">More Google Earth API resource links</a>
      </div>

      <div class="g-unit" id="gc-pagecontent">
        <script type="text/javascript">CODESITE_docEarlyProcessing();</script>


        <h2 class="page_title">KML</h2>



<div class="toc">
<ol>
   <li><a href="#introduction">Introduction</a></li>
   <li><a href="#importing_kml">Importing KML</a></li>
   <li><a href="#kmlnetworklink">KmlNetworkLink</a></li>
   <li><a href="#fetchkml_and_parsekml">fetchKml and parseKml</a></li>
   <li><a href="#getting_kml">Getting a feature's KML representation</a></li>
</ol>
</div>

<h2 id="introduction">Introduction</h2> 
 
<p>KML is an open-standard markup language for the display of geographic data in
   geo-browsers. The Google Earth Plugin can import KML in different ways, in order
   to display features, tours, and views. The plugin supports all <a href="http://code.google.com/apis/kml/documentation/reference.html">KML
   2.2</a> tags, as
   well as <a href="http://code.google.com/apis/kml/documentation/kmlreference.html#kmlextensions">extensions to KML using the gx namespace.</a></p>
<p>The plugin can also <a href="#getting_kml">return KML representations</a> of features, whether those
   features were imported as KML or created with the API.</p>
<p>The information in this document is a reference guide to KML import functions.
   For additional walkthroughs and examples of importing KML, please read <a href="../articles/earthapikml.html">An
   Overview of Using KML in the Earth API</a>, in the <strong>Articles</strong> section
   of this site.</p>

<h2 id="importing_kml">Importing KML</h2>
<p>There are three methods of importing KML into the plugin.</p>
<div class="defs">
<p><a href="#kmlnetworklink">KmlNetworkLink</a> loads a KML or KMZ file from a specified URL. The fetched KML can
   then be added to the plugin just as any other object, using <code>ge.getFeatures().appendChild()</code>.</p>
<p><a href="#fetchkml">fetchKml</a> also loads KML from a URL, but returns a KmlFeature
   object representing the root KML feature. The object's KML DOM can be accessed
   and updated before it is appended to the plugin's KML DOM.</p>
<p><a href="#parsekml">parseKml</a> takes a KML string, and also returns a KmlFeature object. As with <code>fetchKml</code>, the returned object's KML DOM can be accessed.</p>
</div>

<p>Each method is described in more detail below.</p>

<h2 id="kmlnetworklink">KmlNetworkLink</h2>
<p><code>KmlNetworkLink</code> references a KML or KMZ file by its URL. The contents
   of the file can be added into the Earth instance, but they cannot be manipulated
   before being displayed - there is no access to the KML's DOM. A NetworkLink is
   a standard way of importing content in the KML language; refer to the <a href="http://code.google.com/apis/kml/documentation/kmlreference.html#networklink">KML
   Reference</a> for more information.</p>
<p><strong>Source</strong>: <a href="samples/kmlnetworklink_example.html">http://code.google.com/apis/earth/documentation/samples/kmlnetworklink_example.html</a></p>
<pre class="prettyprint">
var link = ge.createLink('');
var href = 'http://code.google.com/'
           + 'apis/earth/documentation/samples/kml_example.kml'
link.setHref(href);

var networkLink = ge.createNetworkLink('');
networkLink.set(link, true, true); // Sets the link, refreshVisibility, and flyToView

ge.getFeatures().appendChild(networkLink);
</pre>

<h3>Flying to a view in the KML file</h3>
<p>KmlNetworkLink accepts a <code>flyToView</code> argument. Setting this to true will update the plugin's view to the first LookAt or Camera view in the Document level of the KML file, if one exists. The example above uses <code>set(link, true, true)</code>, with the last argument referring to flyToView. You can also call <code>setFlyToView(true)</code> for the same result.</p>

<h2 id="fetchkml_and_parsekml">fetchKml and parseKml</h2>
<p><code>fetchKml</code> and <code>parseKml</code> accept  KML in different ways,
   but both return a KmlFeature object, allowing for access to, and manipulation
   of, the object's hierarchy (its children and other descendant features). For information
   about available functions, refer to the <a href="containers.html">Containers</a> chapter
   of this Developer's
   Guide.</p>
<p><code>fetchKml</code> calls the specified callback function when a success or failure message is returned; <code>parseKml</code> returns the object immediately. <code>fetchKml</code>'s asynchronous behavior allows the plugin to continue while the network fetch is completing.</p>
<h3 id="fetchkml">fetchKml</h3>
<p><strong>Source</strong>: <a href="samples/fetchkml_example.html">http://code.google.com/apis/earth/documentation/samples/fetchkml_example.html</a></p>
<p><code>fetchKml</code> requires the URL of a KML or KMZ file, and returns a KmlFeature
   object.</p>

<pre class="prettyprint">
var href = 'http://code.google.com/'
           + 'apis/earth/documentation/samples/kml_example.kml';

google.earth.fetchKml(ge, href, function(kmlObject) {
      if (kmlObject)
         ge.getFeatures().appendChild(kmlObject);
});</pre>
<h3 id="parsekml">parseKml</h3>
<p><strong>Source</strong>: <a href="samples/parsekml_example.html">http://code.google.com/apis/earth/documentation/samples/parsekml_example.html</a></p>
<p><code>parseKml</code> requires a KML string, and returns a KmlFeature object.</p>
<pre class="prettyprint">
var kmlString = ''
              + '&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;'
              + '&lt;kml xmlns=&quot;http://www.opengis.net/kml/2.2&quot;&gt;'

              + '&lt;Document&gt;'
              + '  &lt;Camera&gt;'
              + '    &lt;longitude&gt;-122.444633&lt;/longitude&gt;'
              + '    &lt;latitude&gt;37.801899&lt;/latitude&gt;'
              + '    &lt;altitude&gt;139.629438&lt;/altitude&gt;'
              + '    &lt;heading&gt;-70.0&lt;/heading&gt;'
              + '    &lt;tilt&gt;75&lt;/tilt&gt;'
              + '  &lt;/Camera&gt;'

              + '  &lt;Placemark&gt;'
              + '    &lt;name&gt;Placemark from KML string&lt;/name&gt;'
              + '    &lt;Point&gt;'
              + '      &lt;coordinates&gt;-122.448425,37.802907,0&lt;/coordinates&gt;'
              + '    &lt;/Point&gt;'
              + '  &lt;/Placemark&gt;'

              + '&lt;/Document&gt;'
              + '&lt;/kml&gt;';

var kmlObject = ge.parseKml(kmlString);
ge.getFeatures().appendChild(kmlObject);
</pre>

<h3>Flying to a view in the KML file</h3>
<p><code>fetchKml</code> and <code>parseKml</code> don't support <code>flyToView()</code>, as <code>KmlNetworkLink</code> does. If your
   KML file has a LookAt or Camera element at the top level of the Document container,
   you can get the view and assign it as the plugin's view:</p>
<pre class="prettyprint">
if (kmlObject.getAbstractView())
   ge.getView().setAbstractView(kmlObject.getAbstractView());
</pre>

<h3>Accessing and modifying the DOM</h3>
<p>The fetched KML object's DOM can be accessed and modified before or after the
   KML features are displayed. In the example below, a placemark is created using
   the Earth API, and is then appended to the KML object returned by the <code>fetchKml()</code> or
   <code>parseKml()</code> function. When the KML object is added to Earth,
   the API-created placemark is included.</p>

<p><img src="images/fetchkml_dom_example.gif" /></p>
<p><strong>KML</strong>: <a href="samples/kml_example.kml">http://code.google.com/apis/earth/documentation/samples/kml_example.kml</a></p>
<pre class="prettyprint">
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;kml xmlns=&quot;http://www.opengis.net/kml/2.2&quot;&gt;

&lt;Document&gt;
  &lt;Camera&gt;
    &lt;longitude&gt;-122.444633&lt;/longitude&gt;
    &lt;latitude&gt;37.801899&lt;/latitude&gt;
    &lt;altitude&gt;139.629438&lt;/altitude&gt;
    &lt;heading&gt;-70.0&lt;/heading&gt;
    &lt;tilt&gt;75&lt;/tilt&gt;
  &lt;/Camera&gt;

  &lt;Placemark&gt;
    &lt;name&gt;Placemark from KML file&lt;/name&gt;
    &lt;Point&gt;
      &lt;coordinates&gt;-122.448425,37.802907,0&lt;/coordinates&gt;
    &lt;/Point&gt;
  &lt;/Placemark&gt;

&lt;/Document&gt;
&lt;/kml&gt;
</pre>

<p><strong>HTML</strong>: <a href="samples/fetchkml_dom_example.html">http://code.google.com/apis/earth/documentation/samples/fetchkml_dom_example.html</a></p>
<pre class="prettyprint">
var placemark = ge.createPlacemark('');
var point = ge.createPoint('');
point.setLatLng(37.803521, -122.450274);
placemark.setName('Placemark from Earth API');
placemark.setGeometry(point);

var href = 'http://code.google.com/apis/earth/'
         + 'documentation/samples/kml_example.kml'
google.earth.fetchKml(ge, href, function(kmlObject) {
   if (kmlObject) {
      if ('getFeatures' in kmlObject) {
         kmlObject.getFeatures().appendChild(placemark);
      }
      ge.getFeatures().appendChild(kmlObject);
      if (kmlObject.getAbstractView())
         ge.getView().setAbstractView(kmlObject.getAbstractView());
   }
});
</pre>
<p>You can use <code>KmlFeature.getKml()</code>, as described below, to confirm that the placemark has been added to the object.</p>

<h2 id="getting_kml">Getting a feature's KML representation</h2>
<p>The Google Earth Plugin can provide a feature's KML representation, so that the
   feature can be displayed in any KML-compatible application. To obtain a feature's
   KML, use <code>KmlFeature.getKml()</code>.</p>
<p><strong>Source</strong>: <a href="samples/getkml_example.html">http://code.google.com/apis/earth/documentation/samples/getkml_example.html</a></p>

<pre class="prettyprint">
var placemark = ge.createPlacemark('');
var point = ge.createPoint('');
point.setLatLng(37.803521, -122.450274);
placemark.setName('Placemark from Earth API');
placemark.setGeometry(point);
ge.getFeatures().appendChild(placemark);

var output = placemark.getKml();
output = formatKmlForHtml(output); // Replaces special characters with their character entities
document.getElementById('output_div').innerHTML = '&lt;pre&gt;' + output + '&lt;/pre&gt;';
</pre>

<p>The <code>formatKmlForHtml()</code> function is below. It replaces angle brackets with their ASCII-equivalents, so that the KML file will display as text in the browser. In addition, it replaces tabs with two spaces, and formats the XML namespace declarations.</p>
<pre class="prettyprint">
function formatKmlForHtml(output) {
   output = output.replace(/&lt;/g, '&amp;lt;').replace(/&gt;/g, '&amp;gt;');
   output = output.replace(/\t/g, '  ');
   output = output.replace(/\&quot; xmlns/g, '\&quot;\n     xmlns');
   return output;
}
</pre>



</p>
</div>
<!-- end gc-pagecontent -->
   </div><!-- end gooey wrapper -->

    </div> <!-- end codesite content -->


<div id="gc-footer" dir="ltr">
  <div class="text">
    
    &copy;2010 Google -
    <a href="http://code.google.com">Code Home</a> -
    <a href="http://code.google.com/terms.html">Terms of Service</a> -
    <a href="http://code.google.com/privacy.html">Privacy Policy</a> -
    <a href="http://code.google.com/more">Site Directory</a>
    <br> <br>
    Google Code offered in:
    <a href="http://code.google.com/intl/en">English</a> -
    <a href="http://code.google.com/intl/es">Español</a> -
    <a href="http://code.google.com/intl/ja">日本語</a> -
    <a href="http://code.google.com/intl/ko">한국어</a> -
    <a href="http://code.google.com/intl/pt-BR">Português</a> -
    <a href="http://code.google.com/intl/ru">Pусский</a> -
    <a href="http://code.google.com/intl/zh-CN">中文(简体)</a> -
    <a href="http://code.google.com/intl/zh-TW">中文(繁體)</a>
  </div>
</div><!-- end gc-footer -->

</div><!-- end gc-container -->

<script type="text/javascript">CODESITE_CSITimer['load'].tick('ats');</script>
<script src="../../../js/codesite_tail.pack.04102009.js" type="text/javascript"></script>




<script type="text/javascript">
var _gaq = _gaq || [];

_gaq.push(


    ['siteTracker._setAccount', 'UA-18071-1'],
    ['siteTracker._setDomainName', 'code.google.com'],
    ['siteTracker._setCookiePath', window.location.pathname.substring(0,
        window.location.pathname.lastIndexOf('/') + 1)],
    ['siteTracker._trackPageview']
);
(function() {
  var ga = document.createElement('script');

  ga.type = 'text/javascript';
  ga.async = true;
  ga.src = 'http://www.google-analytics.com/ga.js';
  (document.getElementsByTagName('head')[0] ||
   document.getElementsByTagName('body')[0]).appendChild(ga);
 })();
</script>




  </body>
</html>

