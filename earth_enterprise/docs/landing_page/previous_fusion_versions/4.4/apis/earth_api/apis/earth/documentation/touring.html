<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">









 


   
  
  


<html>
  <head>
    <script type="text/javascript" language="JavaScript">
    ORIGINAL_PAGE_PATH = "/apis/earth/documentation/touring.html";
    </script>
    
    
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>Touring - Google Earth API - Google Code</title>
<script type="text/javascript"><!--
(function(){function a(){this.t={};this.tick=function(c){this.t[c]=(new Date).getTime()};this.tick("start")}var b=new a;window.jstiming={Timer:a,load:b};if(window.external&&window.external.pageT)window.jstiming.pt=window.external.pageT;})();

var _tocPath_ = '/apis/earth/documentation/_toc.ezt';
var codesite_token = null;
var logged_in_user_email = null;
//--></script>
<link href="../../../css/codesite.pack.04102009.css" type="text/css" rel="stylesheet">
<script src="../../../js/codesite_head.pack.04102009.js" type="text/javascript"></script>
<script type="text/javascript">CODESITE_CSITimer['load'].tick('bhs');</script>
<link rel="search" type="application/opensearchdescription+xml" title="Google Code" href="http://code.google.com/osd.xml">

<!--[if IE]><link rel="stylesheet" type="text/css" href="../../../css/iehacks.css"><![endif]-->

    <link href="../../../css/semantic_headers.css" rel="stylesheet" type="text/css" />
       <script src="addCommentsToToc.js" type="text/javascript"></script>
  </head>

  <body class="gc-documentation">

    
    
    <div id="gb">
 <span>
  
    <a id="lang-dropdown" class="dropdown" href="http://code.google.com" onclick="return false;"><img width="13" height="13" class="globeicon" src="../../../images/globe2_small.png"
     ><span style="text-decoration:underline">English</span> <span style="font-size:.75em;">&#9660;</span></a>
  
 </span>
</div>

<div class="gbh" style="left:0px;"></div>
<div class="gbh" style="right:0px;"></div>

<div id="gc-container">
<a id="top"></a>
<div id="skipto">
  <a href="#gc-pagecontent">Skip to page content</a>
  <a href="#gc-toc">Skip to main navigation</a>
</div>

<div id="gc-header">
  <div id="logo"><a href="http://code.google.com">
  
  
     <img src="../../../images/code_logo.png" height="40" width="161" alt="Google Code" style="border:0;margin:3px 0 0 0;">
  
  
  </a></div>
  <div id="search">
    <div id="searchForm" class="searchForm">
      <form id="cse" action="http://www.google.com/cse" accept-charset="utf-8" class="gsc-search-box" onsubmit="executeGSearch(document.getElementById('gsearchInput').value); return false;">
      <noscript>
      <input type="hidden" name="cref" value="http://code.google.com/cse/googlecode-context.xml">
      </noscript>
      <div id="gsc-search-box">
        <input id="gsearchInput" type="text" name="q" maxlength="2048" class="gsc-input" autocomplete="off" title="Google Code Search" style="width:345px">
        <div id="cs-searchresults" onclick="event.cancelBubble = true;"></div>
        <input title="Search" id="gsearchButton" class="gsc-search-button" name="sa" value="Search" type="submit">
        <div class="greytext">e.g. "ajax apis" or "open source"</div>
      </div>
      </form>
    </div> <!-- end searchForm -->
  </div> <!-- end search -->



<h2 id="googlecode-promo">Make web development faster with these <a href="http://chrome.google.com/extensions/featured/web_dev" onclick="siteTracker._trackEvent('Promos','Web Development',this.href);">Chrome Extensions</a>!</h2>

</div> <!-- end gc-header -->


<div id="codesiteContent">

<a id="gc-topnav-anchor"></a>
<div id="gc-topnav">
  <h1 style="padding:0 0 0 6px;">Google Earth API</h1>
  <ul id="docs" class="gc-topnav-tabs">

    <li id="home_link">
      <a href="../index.html" title="Google Earth API home page">Home</a>
    </li>
  
    <li id="docs_link">
      <a href="index.html" class="selected" title="Official Google Earth API documentation">Docs</a>
    </li>
  
    <li id="faq_link">
      <a href="../faq.html" title="Answers to frequently asked questions about Google Earth API">FAQ</a>
    </li>
  
    <li id="articles_link">
      <a href="../articles/index.html" title="Focused articles and tutorials for Google Earth API developers">Articles</a>
    </li>
  
    <li>
      <a href="http://googlegeodevelopers.blogspot.com/" title="Official Google Earth API blog">Blog</a>
    </li>
  
    <li>
      <a href="http://groups.google.com/group/google-earth-browser-plugin/topics" title="Google Earth API developer forum">Forum</a>
    </li>
  
    <li>
      <a href="http://code.google.com/apis/maps/terms.html" title="Google Earth API terms of service">Terms</a>
    </li>
  

  </ul>
</div> <!-- end gc-topnav -->

    <div class="g-section g-tpl-170">

      <div class="g-unit g-first" id="gc-toc">
        <ul>
  <li><a href="http://code.google.com/apis/maps/signup.html">Sign up for a Maps API key</a></li>
</ul>

<div class="line"></div>

<ul>

  <li>
    <h2><a href="reference/#">API Reference</a></h2>
    <div class="line"></div>
  </li>
  <li><h2>Developer's Guide</h2>
    <ul>
      <li><a href="index.html">Introduction</a></li>
      <li><a href="placemarks.html">Placemarks</a></li>
      <li><a href="balloons.html">Balloons</a></li>
      <li><a href="geometries.html">Geometries & Overlays</a></li>
      <li><a href="camera_control.html">Camera Control</a></li>
      <li><a href="layers.html">Layers & Controls</a></li>
      <li><a href="time.html">Time</a> <sup class="new">Updated</sup></li>
      <li><a href="ocean.html">Ocean</a></li>
      <li><a href="sky_mars_moon.html">Sky, Mars, & Moon</a></li>
      <li><a href="touring.html">Touring</a></li>
      <li><a href="events.html">Events</a></li>
      <li><a href="accessors.html">Accessors</a> <sup class="new">New!</sup></li>
      <li><a href="containers.html">Object Containers</a></li>
      <li><a href="kml.html">KML</a></li>
      <li><a href="options.html">Options</a></li>
      <li><a href="debugging.html">Debugging</a></li>
    </ul>
  </li>
        
  <div class="line"></div>
    
  <li><h2 class="tlw-expanded">Code Samples</h2>
    <ul>
      <li><a href="examples.html">Examples</a></li>
      <li><a href="demogallery.html">Demo Gallery</a>
      </li>
      <li><a href="http://code.google.com/apis/ajax/playground/?exp=earth">Code Playground</a></li>
    </ul>
  </li>
    
  <div class="line"></div>
    
  <li><h2 class="tlw-expanded">More Resources</h2>
    <ul>
      <li><a href="mediagallery.html">Media</a></li>
      <li><a href="releasenotes.html">Release Notes</a></li>
      <li><a href="http://code.google.com/p/earth-api-utility-library">Utility Library</a></li>
      <li><a href="http://code.google.com/p/earth-api-samples/issues/list?q=label%3AType-Defect">Known Issues</a></li>
    </ul>
  </li>
</ul>

<div class="line"></div>
<ul>
 <li>
    <h2>Related Docs</h2>
    <ul>                
      <li><a href="http://code.google.com/apis/kml/documentation/index.html">KML</a></li>
      <li><a href="http://code.google.com/apis/maps/documentation/index.html">Maps API</a></li>
    </ul>                
 </li>
</ul>
        <a class="hidden" href="#gc-topnav-anchor">More Google Earth API resource links</a>
      </div>

      <div class="g-unit" id="gc-pagecontent">
        <script type="text/javascript">CODESITE_docEarlyProcessing();</script>


        <h1 class="page_title">Touring</h1>



<div class="toc">
<ol>
  <li><a href="#intro">Introduction</a></li>
  <li><a href="#importing">Importing a tour</a></li>
  <li><a href="#active">Defining the active tour</a></li>
  <li><a href="#playback">Controlling tour playback</a></li>
  <li><a href="#querying">Querying tour playback information</a></li>
  <li><a href="#sample">Complete tour playback sample</a></li>
</ol>
</div>

<h2 id="intro">Introduction</h2>
<p>The Google Earth Plugin can play tours authored in KML, allowing viewers to interact with the Earth environment while viewing scripted, controlled tours. The plugin currently exposes tour playback methods; tour authoring is not supported in the plugin.</p>

<h2 id="importing">Importing a tour</h2>
<h3 id="simple_tour">Simple tour</h3>
<p>Simple tours, with the <code>&lt;gx:Tour&gt;</code> feature as the root-level feature of the KML, can be fetched and passed directly to <code>GETourPlayer</code>. The tour must be the only feature in the KML file. If your KML doesn't meet these requirements, refer to the <a href="#complex_tour">Complex tour</a> example below.</p>
<pre class="prettyprint">
&lt;script type=&quot;text/javascript&quot;&gt;
var ge;
google.load(&quot;earth&quot;, &quot;1&quot;);

function init() {
   google.earth.createInstance('map3d', initCB, failureCB);
}

function initCB(instance) {
   ge = instance;
   ge.getWindow().setVisibility(true);
   ge.getNavigationControl().setVisibility(ge.VISIBILITY_SHOW);
 
   var href = 'http://code.google.com/apis/kml/documentation/kmlfiles/bounce_example.kml';
   google.earth.fetchKml(ge, href, kmlFinishedLoading);
}

function kmlFinishedLoading(object) {
   ge.getTourPlayer().setTour(object);
   ge.getTourPlayer().play();
}

function failureCB(errorCode) {
}

google.setOnLoadCallback(init);
&lt;/script&gt;
</pre>

<h3 id="complex_tour">Complex tour</h3>
<p>If your tour is contained within a KMZ file, or if your KML file contains more than just a tour, or if the tour is nested within a container (such as &lt;Document&gt; or &lt;Folder&gt;), you'll need to manually look for the <code>&lt;gx:Tour&gt;</code> feature within the file. One way is to 'walk' through the file's DOM until the KMLTour feature is found. You can use the <code>kmldomwalk.js</code> utility script to do this.</p>
<p>In the example below, the KML file includes some placemarks and features, which need to be loaded into Earth as well.</p>

<p>First, reference the <code>kmldomwalk.js</code> file from your page's <code>&lt;head&gt;</code>:</p>
<pre class="prettyprint">
&lt;script src=&quot;http://earth-api-samples.googlecode.com/svn/trunk/lib/kmldomwalk.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</pre>

<p>Then:</p>
<pre class="prettyprint">
&lt;script type=&quot;text/javascript&quot;&gt;

   var ge;
   var tour;
   google.load(&quot;earth&quot;, &quot;1&quot;);

   function init() {
      google.earth.createInstance('map3d', initCB, failureCB);
   }

   function initCB(instance) {
      ge = instance;
      ge.getWindow().setVisibility(true);
      ge.getNavigationControl().setVisibility(ge.VISIBILITY_SHOW);

      var href = 'http://code.google.com/apis/kml/documentation/kmlfiles/complete_tour_example.kml';
      google.earth.fetchKml(ge, href, fetchCallback);
   }

      function fetchCallback(fetchedKml) {
         // alert if no KML was found at the specified URL
         if (!fetchedKml) {
            setTimeout(function() {
               alert('Bad or null KML');
            }, 0);
            return;
         }

         // add the fetched KML into this Earth instance
         ge.getFeatures().appendChild(fetchedKml);

         // walk through the KML to find the tour object; assign to variable 'tour'
         walkKmlDom(fetchedKml, function() {
            if (this.getType() == 'KmlTour') {
               tour = this;
               return false;
            }
         });
      }

   function failureCB(errorCode) {
   }

   google.setOnLoadCallback(init);

&lt;/script&gt;
</pre>

<p>The preceding code simply loads the fetched tour into the Earth plugin. It doesn't include controls for setting the fetched tour as active, or for controlling playback. Refer to <a href="#active">Defining the active tour</a> and <a href="#playback">Controlling tour playback</a> for more information. The entire tour with controls is included in the <a href="#sample">Sample tour</a> section.</p>

<h2 id="active">Defining the active tour </h2>
<p>Any number of tour objects can be loaded into the plugin, but only one can be set as the currently active tour. Once a tour is set as active, the tour controls appear on the screen:</p>
<pre class="prettyprint">ge.getTourPlayer().setTour(tour);</pre>

<p>Use <code>setTour(null)</code> to exit the currently active tour and to restore normal globe navigation:</p>
<pre class="prettyprint">ge.getTourPlayer().setTour(null);</pre>

<h2 id="playback">Controlling tour playback</h2>
<p>The Earth API supports the following calls to control tour playback:</p>

<table>
  <tr>
    <th>Function</th>
    <th>Description</th>
  </tr>
  <tr>
    <td><code>ge.getTourPlayer().play()</code></td>
    <td>Plays the currently active tour</td>
  </tr>
  <tr>
    <td><code>ge.getTourPlayer().pause()</code></td>
    <td>Pauses the currently active tour</td>
  </tr>
  <tr>
    <td><code>ge.getTourPlayer().reset()</code></td>
    <td>Stops playback of the currently active tour and jumps to the beginning of the tour</td>
  </tr>
  <tr>
    <td><code>ge.getTourPlayer().setCurrentTime(time)</code></td>
    <td>Sets playback to the specified point on the tour's timeline, in seconds.</td>
  </tr>
</table>

<h2 id="querying">Querying tour playback information</h2>
<p>The Earth API supports the following calls to query for current tour playback information:</p>

<table>
  <tr>
    <th>Function</th>
    <th>Description</th>
  </tr>
  <tr>
    <td><code>ge.getTourPlayer().getCurrentTime()</code></td>
    <td>Retrieves the current elapsed playing time of the tour, in seconds.</td>
  </tr>
  <tr>
    <td><code>ge.getTourPlayer().getDuration()</code></td>
    <td>Retrieves the total duration of the active tour, in seconds.</td>
  </tr>
</table>



<h2 id="sample">Complete tour playback sample</h2>
<p>Source: <a href="samples/tour_example.html">http://code.google.com/apis/earth/documentation/samples/tour_example.html</a></p>
<pre class="prettyprint">
&lt;html&gt;
   &lt;head&gt;
      &lt;title&gt;Sample tour in the Google Earth Plugin&lt;/title&gt;
      &lt;script src="http://www.google.com/jsapi?key=ABCDEFG"&gt; &lt;/script&gt; 
      &lt;script src=&quot;http://earth-api-samples.googlecode.com/svn/trunk/lib/kmldomwalk.js&quot; type=&quot;text/javascript&quot;&gt; &lt;/script&gt;
      &lt;script type=&quot;text/javascript&quot;&gt;

         var ge;
         var tour;
         google.load(&quot;earth&quot;, &quot;1&quot;);

         function init() {
            google.earth.createInstance('map3d', initCB, failureCB);
         }

         function initCB(instance) {
            ge = instance;
            ge.getWindow().setVisibility(true);
            ge.getNavigationControl().setVisibility(ge.VISIBILITY_SHOW);

            var href = 'http://code.google.com/apis/kml/documentation/kmlfiles/complete_tour_example.kml';
            google.earth.fetchKml(ge, href, fetchCallback);

            function fetchCallback(fetchedKml) {
               // Alert if no KML was found at the specified URL.
               if (!fetchedKml) {
                  setTimeout(function() {
                     alert('Bad or null KML');
                  }, 0);
                  return;
               }

               // Add the fetched KML into this Earth instance.
               ge.getFeatures().appendChild(fetchedKml);

               // Walk through the KML to find the tour object; assign to variable 'tour.'
               walkKmlDom(fetchedKml, function() {
                  if (this.getType() == 'KmlTour') {
                     tour = this;
                     return false;
                  }
               });
            }
         }

         function failureCB(errorCode) {
         }

         // Tour control functions
         function enterTour() {
            if (!tour) {
               alert('No tour found!');
               return;
            }
            ge.getTourPlayer().setTour(tour);
         }
         function playTour() {
            ge.getTourPlayer().play();
         }
         function pauseTour() {
            ge.getTourPlayer().pause();
         }
         function resetTour() {
            ge.getTourPlayer().reset();
         }
         function exitTour() {
            ge.getTourPlayer().setTour(null);
         }

         google.setOnLoadCallback(init);
      &lt;/script&gt;
   &lt;/head&gt;
   &lt;body&gt;

      &lt;div id=&quot;map3d&quot; style=&quot;height: 400px; width: 600px;&quot;&gt;&lt;/div&gt;
      &lt;div id =&quot;controls&quot;&gt;
         &lt;input type=&quot;button&quot; onclick=&quot;enterTour()&quot; value=&quot;Enter Tour&quot;/&gt;
         &lt;input type=&quot;button&quot; onclick=&quot;playTour()&quot; value=&quot;Play Tour&quot;/&gt;
         &lt;input type=&quot;button&quot; onclick=&quot;pauseTour()&quot; value=&quot;Pause Tour&quot;/&gt;
         &lt;input type=&quot;button&quot; onclick=&quot;resetTour()&quot; value=&quot;Stop/Reset Tour&quot;/&gt;
         &lt;input type=&quot;button&quot; onclick=&quot;exitTour()&quot; value=&quot;Exit Tour&quot;/&gt;
      &lt;/div&gt;

   &lt;/body&gt;
&lt;/html&gt;
</pre>
<p>
<p>
<h3 id="simple_tour">&nbsp;</h3>


   
   
   
         
</div><!-- end gc-pagecontent -->
   </div><!-- end gooey wrapper -->

    </div> <!-- end codesite content -->


<div id="gc-footer" dir="ltr">
  <div class="text">
    
    &copy;2010 Google -
    <a href="http://code.google.com">Code Home</a> -
    <a href="http://code.google.com/terms.html">Terms of Service</a> -
    <a href="http://code.google.com/privacy.html">Privacy Policy</a> -
    <a href="http://code.google.com/more">Site Directory</a>
    <br> <br>
    Google Code offered in:
    <a href="http://code.google.com/intl/en">English</a> -
    <a href="http://code.google.com/intl/es">Español</a> -
    <a href="http://code.google.com/intl/ja">日本語</a> -
    <a href="http://code.google.com/intl/ko">한국어</a> -
    <a href="http://code.google.com/intl/pt-BR">Português</a> -
    <a href="http://code.google.com/intl/ru">Pусский</a> -
    <a href="http://code.google.com/intl/zh-CN">中文(简体)</a> -
    <a href="http://code.google.com/intl/zh-TW">中文(繁體)</a>
  </div>
</div><!-- end gc-footer -->

</div><!-- end gc-container -->

<script type="text/javascript">CODESITE_CSITimer['load'].tick('ats');</script>
<script src="../../../js/codesite_tail.pack.04102009.js" type="text/javascript"></script>




<script type="text/javascript">
var _gaq = _gaq || [];

_gaq.push(


    ['siteTracker._setAccount', 'UA-18071-1'],
    ['siteTracker._setDomainName', 'code.google.com'],
    ['siteTracker._setCookiePath', window.location.pathname.substring(0,
        window.location.pathname.lastIndexOf('/') + 1)],
    ['siteTracker._trackPageview']
);
(function() {
  var ga = document.createElement('script');

  ga.type = 'text/javascript';
  ga.async = true;
  ga.src = 'http://www.google-analytics.com/ga.js';
  (document.getElementsByTagName('head')[0] ||
   document.getElementsByTagName('body')[0]).appendChild(ga);
 })();
</script>




  </body>
</html>

