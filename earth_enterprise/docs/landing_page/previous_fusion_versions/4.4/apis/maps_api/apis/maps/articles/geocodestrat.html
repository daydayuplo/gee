<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">







 
 


 

  
  
  


<html>
  <head>
    <script type="text/javascript" language="JavaScript">
    ORIGINAL_PAGE_PATH = "/apis/maps/articles/geocodestrat.html";
    </script>
    
    
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>Geocoding Strategies - Google Maps API Family - Google Code</title>
<script type="text/javascript"><!--
(function(){function a(){this.t={};this.tick=function(c){this.t[c]=(new Date).getTime()};this.tick("start")}var b=new a;window.jstiming={Timer:a,load:b};if(window.external&&window.external.pageT)window.jstiming.pt=window.external.pageT;})();

var _tocPath_ = '/apis/maps/_toc.ezt';
var codesite_token = null;
var logged_in_user_email = null;
//--></script>
<link href="../../../css/codesite.pack.04102009.css" type="text/css" rel="stylesheet">
<script src="../../../js/codesite_head.pack.04102009.js" type="text/javascript"></script>
<script type="text/javascript">CODESITE_CSITimer['load'].tick('bhs');</script>
<link rel="search" type="application/opensearchdescription+xml" title="Google Code" href="http://code.google.com/osd.xml">

<!--[if IE]><link rel="stylesheet" type="text/css" href="../../../css/iehacks.css"><![endif]-->

    <link href="../../../css/semantic_headers.css" rel="stylesheet" type="text/css" />
  </head>

  <body class="gc-documentation">

    
    
    <div id="gb">
 <span>
  
    <a id="lang-dropdown" href="http://code.google.com" onclick="return false;"><span style="text-decoration:underline">English</span> <span style="font-size:.75em;">&#9660;</span></a>
  
 </span>
</div>

<div class="gbh" style="left:0px;"></div>
<div class="gbh" style="right:0px;"></div>

<div id="gc-container">
<a id="top"></a>
<div id="skipto">
  <a href="#gc-pagecontent">Skip to page content</a>
  <a href="#gc-toc">Skip to main navigation</a>
</div>

<div id="gc-header">
  <div id="logo"><a href="http://code.google.com">
  
  
     <img src="../images/code_logo.gif" height="40" width="167" alt="Google Code" style="border:0;margin:3px 0 0 0;">
  
  
  </a></div>
  <div id="search">
    <div id="searchForm" class="searchForm">
      <form id="cse" action="http://www.google.com/cse" accept-charset="utf-8" class="gsc-search-box" onsubmit="executeGSearch(document.getElementById('gsearchInput').value); return false;">
      <noscript>
      <input type="hidden" name="cref" value="http://code.google.com/cse/googlecode-context.xml">
      </noscript>
      <div id="gsc-search-box">
        <input id="gsearchInput" type="text" name="q" maxlength="2048" class="gsc-input" autocomplete="off" title="Google Code Search" style="width:345px">
        <div id="cs-searchresults" onclick="event.cancelBubble = true;"></div>
        <input title="Search" id="gsearchButton" class="gsc-search-button" name="sa" value="Search" type="submit">
        <div class="greytext">e.g. "adwords" or "open source"</div>
      </div>
      </form>
    </div> <!-- end searchForm -->
  </div> <!-- end search -->




</div> <!-- end gc-header -->


<div id="codesiteContent">

<a id="gc-topnav-anchor"></a>
<div id="gc-topnav">
  <h1 style="padding:0 0 0 6px;">Google Maps API Family</h1>
  <ul id="articles" class="gc-topnav-tabs">

    <li id="home_link">
      <a href="../index.html" title="Google Maps API Family home page">Home</a>
    </li>
  
    <li id="faq_link">
      <a href="../faq.html" title="Answers to frequently asked questions about Google Maps API Family">FAQ</a>
    </li>
  
    <li id="articles_link">
      <a href="index.html" class="selected" title="Focused articles and tutorials for Google Maps API Family developers">Articles</a>
    </li>
  
    <li>
      <a href="http://googlegeodevelopers.blogspot.com/" title="Official Google Maps API Family blog">Blog</a>
    </li>
  
    <li>
      <a href="../forum/index.html" title="Google Maps API Family developer forum">Forum</a>
    </li>
  
    <li>
      <a href="../terms.html" title="Google Maps API Family terms of service">Terms</a>
    </li>
  

  </ul>
</div> <!-- end gc-topnav -->

    <div class="g-section g-tpl-170">

      <div class="g-unit g-first" id="gc-toc">
        <ul>
  <li><a href="../index.html">Maps API Family</a></li>
  <li><a href="http://code.google.com/apis/kml/documentation/kmlSearch.html">Index Your Maps Content</a></li>
</ul>
      <div class="line"></div>
      <ul>
        <li><h2>Maps Javascript API V3</h2>
         <ul>
           <li><a href="../documentation/javascript/index.html">Home Page</a></li>
           <li><a href="../documentation/javascript/basics.html">Documentation</a></li>
         </ul>
       </li>
      </ul>
      <ul>
        <li><h2>Maps Javascript API V2</h2>
         <p><span style="color:grey">(Deprecated API)</span></p>
         <ul>
           <li><a href="../documentation/javascript/v2/index.html">Home Page</a></li>
           <li><a href="../documentation/javascript/v2/basics.html">Documentation</a></li>
         </ul>
       </li>
      </ul>
  <div class="line"></div>
    <ul>
      <li><h2>Maps API for Flash</h2>
        <ul>
          <li><a href="../documentation/flash/index.html">Home Page</a></li>
          <li><a href="../documentation/flash/intro.html">Documentation</a></li>
        </ul>
      </li>
    </ul>
    <div class="line"></div>
    <ul>
      <li><h2>Maps Data API</h2>
        <p><span style="color:grey">(Deprecated API)</span></p>
        <ul>
          <li><a href="../documentation/mapsdata/index.html">Home Page</a></li>
          <li><a href="../documentation/mapsdata/developers_guide_protocol.html">Documentation</a></li>
        </ul>
      </li>
    </ul>
     <div class="line"></div>
      <ul>
        <li><h2><a href="../documentation/webservices/index.html">Maps Web Services</a></h2>
         <ul>
           <li><a href="../documentation/geocoding/index.html">Geocoding Guide</a></li>
           <li><a href="../documentation/directions/index.html">Directions Guide</a></li>
           <li><a href="../documentation/elevation/index.html">Elevation Guide</a></li>
           <li><a href="../documentation/places/index.html">Places Guide</a></li>
         </ul>
       </li>
      </ul>
      <div class="line"></div>
        <ul>
          <li><h2>Static Maps API</h2>
            <ul>
              <li><a href="../documentation/staticmaps/index.html">Developer Guide</a></li>
            </ul>
          </li>
        </ul>
      <div class="line"></div>
        <ul>
          <li><h2>Earth API</h2>
            <ul>
              <li><a href="http://code.google.com/apis/earth">Home Page</a></li>
              <li><a href="http://code.google.com/apis/earth/documentation">Documentation</a></li>
            </ul>
          </li>
        </ul>
      <div class="line"></div>
        <ul>
          <li>
            <h2>Local Search API</h2>
            <p><span style="color:grey">(Deprecated API)</span></p>
            <ul>
              <li>
                <a href="../documentation/localsearch/index.html">Home Page</a>
              </li>
              <li>
                <a href="../documentation/localsearch/start.html">Documentation</a>
              </li>
            </ul>
          </li>
        </ul>
      <div class="line"></div>
      <div class="promo">
     <p><a href="../documentation/premier/index.html">Google Maps API Premier</a></p><p>Includes enterprise licensing and support</p></div>

        <a class="hidden" href="#gc-topnav-anchor">More Google Maps API Family resource links</a>
      </div>

      <div class="g-unit" id="gc-pagecontent">
        <h1 class="page_title">Geocoding Strategies</h1>


<!-- ########## PAGE CONTENT ########## -->
<div class="i">
<i>Mano Marks, Google Geo APIs Team</i>
<br/>
<em>June 2010</em>
<h2>Content</h2>
<ol>
<li><a href="#intro">Introduction</a></li>
<li><a href="#quota-limits">Quota Considerations</a></li>
<li><a href="#caching">Caching Considerations</a></li>
<li><a href="#client">When to use Client-Side Geocoding</a></li>
<li><a href="#server">When to use Server-Side Geocoding</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ol>
<a name="intro"></a>
<h1>Introduction</h1>
<p class="para">Geocoding is the process of converting addresses (like "1600
 Amphitheatre Parkway, Mountain View, CA") into geographic coordinates (like
 latitude 37.423021 and longitude -122.083739), which you can use to place
 markers or position the map. The Google Maps API Family provides two
 approaches to geocoding:</p>
<ol>
  <li>Client-side geocoding, which is executed in the browser, generally in
 response to user action. The Google Maps JavaScript API V3 provides classes
 that make the requests for you. This approach is described in the Maps API
 for JavaScript <a href="http://code.google.com/apis/maps/documentation/
javascript/services.html" target="_blank">documentation</a> and the Maps Flash
 API <a href="http://code.google.com/apis/maps/documentation/flash/
services.html#Geocoding" target="_blank">documentation</a>.</li>
  <li>HTTP server-side geocoding, which allows your server to directly query
 Google's servers for geocodes. Typically, this is integrated with other code.
 that is running server-side, and then used to generate a map. Server-side
 geocoding is described in the Geocoding API
 <a href="http://code.google.com/apis/maps/documentation/geocoding/index.html"
 target="_blank">documentation</a>.
</ol>
<p class="para">Here is a sample of client-side geocoding which takes an
 address, geocodes it, moves the center of the map to that location and adds
 a map marker there.</p>
<pre class="prettyprint lang-javascript">

geocoder = new google.maps.Geocoder();
geocoder.geocode( { 'address': address}, function(results, status) {
  if (status == google.maps.GeocoderStatus.OK) {
    map.setCenter(results[0].geometry.location);
    var marker = new google.maps.Marker({
    map: map,
    position: results[0].geometry.location
  });

</pre>
<p class="para">Here is an example of using Python to do a server-side
 geocoding request.</p>
<pre class="prettyprint lang-python">
import urllib2

address="1600+Amphitheatre+Parkway,+Mountain+View,+CA"
url="http://maps.google.com/maps/api/geocode/json?address=%s&sensor=false" % address

response = urllib2.urlopen(url)
jsongeocode = response.read()
</pre>
<p class="para">This produces a JSON object with the following content:</p>
<pre class="prettyprint lang-javascript">
{
  "status": "OK",
  "results": [ {
    "types": [ "street_address" ],
    "formatted_address": "1600 Amphitheatre Pkwy, Mountain View, CA 94043, USA",
    "address_components": [ {
      "long_name": "1600",
      "short_name": "1600",
      "types": [ "street_number" ]
    }, {
      "long_name": "Amphitheatre Pkwy",
      "short_name": "Amphitheatre Pkwy",
      "types": [ "route" ]
    }, {
      "long_name": "Mountain View",
      "short_name": "Mountain View",
      "types": [ "locality", "political" ]
    }, {
      "long_name": "San Jose",
      "short_name": "San Jose",
      "types": [ "administrative_area_level_3", "political" ]
    }, {
      "long_name": "Santa Clara",
      "short_name": "Santa Clara",
      "types": [ "administrative_area_level_2", "political" ]
    }, {
      "long_name": "California",
      "short_name": "CA",
      "types": [ "administrative_area_level_1", "political" ]
    }, {
      "long_name": "United States",
      "short_name": "US",
      "types": [ "country", "political" ]
    }, {
      "long_name": "94043",
      "short_name": "94043",
      "types": [ "postal_code" ]
    } ],
    "geometry": {
      "location": {
        "lat": 37.4220323,
        "lng": -122.0845109
      },
      "location_type": "ROOFTOP",
      "viewport": {
        "southwest": {
          "lat": 37.4188847,
          "lng": -122.0876585
        },
        "northeast": {
          "lat": 37.4251799,
          "lng": -122.0813633
        }
      }
    }
  } ]
}
</pre>
<p class="para">The server-side geocoder also provies an XML format as an
 alternative to getting JSON</p>
<p class="para">This article describes the use cases for each  approach.</p>
<a name="quota-limits"></a>
<h1>Quota Considerations</h1>
<p class="para">Server-side geocoding, through the Geocoding Web Service has
 a quota of 2,500 requests per IP per day, so all requests in one day count
 against the quota. In addition, the Web Service is rate-limited, so that
 requests that come in too quickly result in blocking. Client-side geocoding
 through the browser is rate limited per map session, so the geocoding is
 distributed across all your users and scales with your userbase.
 Geocoding quotas and rate limits drive the strategies outlined in this article.</p>
<p class="para">In Google Maps API Premier, quotas are tied to <emp>client
 IDs</emp>, which provide much higher quotas. If you are
 still running into quota limits using Premier, file a support request here
<a href="http://www.google.com/support/enterprise/bin/static.py?page=
portal_login.html">http://www.google.com/support/enterprise/bin/static.py?
page=portal_login.html</a>.</p>
<a name="caching"></a>
<h1>Caching Considerations</h1>
<p class="para">The Google Maps API allows you to cache geocodes, (store
 them on your server for a limited period). Caching can be useful if you have to
 repeatedly look up the same address. However, there are two important things
 to keep in mind.</p>
<ol><li>The Google Maps API Terms of Service allow you to use geocodes derived
 from the service on Google Maps or Google Earth only. You may not sell or
 distribute them in other fashion.</li>
</li>
<li>Geocoding changes often as our data gets more and more accurate. So even if
 you have cached data, you should refresh it periodically, to make sure you are
 getting the best geocodes for your locations.</li>
</ol>
<p class="para">The Google Maps API for Flash requires the use of API keys.
 Many people mistakenly think quotas are tied to keys. However, keys don't
 effect your geocoding quota at all. Registering for a new key won't help.
 Quota is solely tied to IP addresses. Therefore a new key won't give you any
 more quota at a particular IP address.</p>
<a name="client"></a>
<h1>When to Use Client-Side Geocoding</h1>
<p class="para">The basic answer is "almost always". As geocoding limits are
 per IP address, that limit counts against the consumer of your application.
 It's going to be very rare that someone is going to enter more than 2,500
 addresses a day sitting at their computer. Therefore, running client-side
 geocoding, you generally don't have to worry about your quota.</p>
<p class="para">Two basic architectures for client-side geocoding exist.</p>
<ol><li>Run the geocoding and display entirely in the browser. For instance,
 the user enters an address on your page. Your application geocodes it. Then
 your page uses the geocode to create a marker on the map. Or your app does
 some simple analysis using the geocode. No data is sent to your server.
 This reduces load on your server, but doesn't give you any sense
 of what your users are doing.</li>
<li>Run the geocode in the browser and then send it to the server.
 For instance, the user enters an address. Your application geocodes it, in
 the browser. The app then sends the data to your server. The server responds
 with some data, such as nearby points of interest. This allows
 you to customize a response based on your own data, and also to cache the
 geocode if want. This cache allows you to optimize even more. You can even
 query the server with the address, see if you have a recently cached geocode
 for it, and if you do, use that. If you don't, then return no result to the
 browser, and let it geocode the result and send it back to the server to for
 caching. </p></li>
<p class="para">On a cautionary note, some mobile networks share IP addresses among many
 phones. That can cause problems for your client side app. If a lot of people
 on their smart phones are looking at your map. If you anticipate heavy mobile
 use, you might consider having a server-side back-up as a fail-over. Try to
 geocode in the browser and if that doesn't work, send the address to your
 server for http geocoding.</p>
</ol>
<a name="server"></a>
<h1>When to Use Server-Side Geocoding</h1>
<p class="para">Server-Side Geocoding is best used for applications that
 require you to geocode addresses without input from a client. This usually
 happens when you get a dataset that comes separately from user input,
 for instance if you have a database of fixed, finite, and known set of
 addresses that need geocodes. Server-side geocoding can
 also be useful as a back-up for when client-side geocoding fails.</p>
<p class="para">You should be wary of relying on server-side geocoding. The
 2,500 request limit is per IP address. All people using your application are
 sharing your single server. If you are processing requests that come in from
 a large number of clients, you could easily overload your quota for the day,
 or even the queries per second from the same IP address. Also, many cloud
 computing infrastructures, such as Google App Engine or Amazon Web Services,
 share IP addresses between different applications. Your requests may run up
 against quota used by other applications wholely outside your control.</p>

<p class="para">The basic archtecture for a server-side geocoding application is
 the following:
 <ul><li>A server based application sends an address to the server's geocoding
 script.</li>
<li>The script checks the cache to see if the address has recently been
 geocoded.</li>
<li>If it has, the script returns that geocode to the original application.
</li>
<li>If it has not, the script sends a geocoding request to Google. Once it has
 a result, it caches it, and then returns the geocode to the original
 application.</li>
<li>Sometime later, the geocode is used to display data on a Google Map.</li>
</ul>
<a name="conclusion"></a>
<h1>Conclusion</h1>
<p class="para">In general, a combination of client-side geocoding and caching will serve
 most of your needs, and the generous geocoding limits in place in the
 JavaScript API will be more than most applications need. You should be careful
 implementing server-side only, as you're very likely to run into quota issues
 if you geocode too fast or too much. If after designing your site, you're still
 running into problems with quota, you may consider a Maps API Premier license.
 Check out <a href="http://maps.google.com/getmaps" target="_blank">Get Maps</a>
 for more information on the differences and how to get started.</p>

<!-- ########## END PAGE CONTENT ########## -->


      </div><!-- end gc-pagecontent -->
   </div><!-- end gooey wrapper -->

    </div> <!-- end codesite content -->


<div id="gc-footer" dir="ltr">
  <div class="text">
    
    &copy;2010 Google -
    <a href="http://code.google.com">Code Home</a> -
    <a href="http://code.google.com/terms.html">Terms of Service</a> -
    <a href="http://code.google.com/privacy.html">Privacy Policy</a> -
    <a href="http://code.google.com/more">Site Directory</a>
    <br> <br>
    Google Code offered in:
    <a href="http://code.google.com/intl/en">English</a> -
    <a href="http://code.google.com/intl/es">Español</a> -
    <a href="http://code.google.com/intl/ja">日本語</a> -
    <a href="http://code.google.com/intl/ko">한국어</a> -
    <a href="http://code.google.com/intl/pt-BR">Português</a> -
    <a href="http://code.google.com/intl/ru">Pусский</a> -
    <a href="http://code.google.com/intl/zh-CN">中文(简体)</a> -
    <a href="http://code.google.com/intl/zh-TW">中文(繁體)</a>
  </div>
</div><!-- end gc-footer -->

</div><!-- end gc-container -->

<script type="text/javascript">CODESITE_CSITimer['load'].tick('ats');</script>
<script src="../../../js/codesite_tail.pack.04102009.js" type="text/javascript"></script>




<script type="text/javascript">
var _gaq = _gaq || [];

_gaq.push(


    ['siteTracker._setAccount', 'UA-18071-1'],
    ['siteTracker._setDomainName', 'code.google.com'],
    ['siteTracker._setCookiePath', window.location.pathname.substring(0,
        window.location.pathname.lastIndexOf('/') + 1)],
    ['siteTracker._trackPageview']
);
(function() {
  var ga = document.createElement('script');

  ga.type = 'text/javascript';
  ga.async = true;
  ga.src = 'http://www.google-analytics.com/ga.js';
  (document.getElementsByTagName('head')[0] ||
   document.getElementsByTagName('body')[0]).appendChild(ga);
 })();
</script>




  </body>
</html>


