<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">








 
 



 



  

  


<html>
  <head>
    <script type="text/javascript" language="JavaScript">
    ORIGINAL_PAGE_PATH = "/apis/maps/documentation/javascript/v2/events.html";
    </script>
    
    
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>Google Maps JavaScript API V2 Events - Google Maps JavaScript API V2 - Google Code</title>
<script type="text/javascript"><!--
(function(){function a(){this.t={};this.tick=function(c){this.t[c]=(new Date).getTime()};this.tick("start")}var b=new a;window.jstiming={Timer:a,load:b};if(window.external&&window.external.pageT)window.jstiming.pt=window.external.pageT;})();

var _tocPath_ = '/html/apis/maps/documentation/javascript/v2/_toc.ezt';
var codesite_token = null;
var logged_in_user_email = null;
//--></script>
<link href="../../../../../css/codesite.pack.04102009.css" type="text/css" rel="stylesheet">
<script src="../../../../../js/codesite_head.pack.04102009.js" type="text/javascript"></script>
<script type="text/javascript">CODESITE_CSITimer['load'].tick('bhs');</script>
<link rel="search" type="application/opensearchdescription+xml" title="Google Code" href="http://code.google.com/osd.xml">

<!--[if IE]><link rel="stylesheet" type="text/css" href="../../../../../css/iehacks.css"><![endif]-->

<link href="../../local_extensions.css" rel="stylesheet" type="text/css" />
  </head>

  <body class="gc-documentation">

    <div id="gb">
 <span>
  
    <a id="lang-dropdown" href="http://code.google.com" onclick="return false;"><span style="text-decoration:underline">English</span> <span style="font-size:.75em;">&#9660;</span></a>
  
 </span>
</div>

<div class="gbh" style="left:0px;"></div>
<div class="gbh" style="right:0px;"></div>

<div id="gc-container" class="depr">
<a id="top"></a>
<div id="skipto">
  
  
</div>

<div id="gc-header">
  <div id="logo"><a href="http://code.google.com">
  
  
     <img src="../images/code_logo.gif" height="40" width="167" alt="Google Code" style="border:0;margin:3px 0 0 0;">
  
  
  </a></div>
  <div id="search">
    <div id="searchForm" class="searchForm">
      <form id="cse" action="http://www.google.com/cse" accept-charset="utf-8" class="gsc-search-box" onsubmit="executeGSearch(document.getElementById('gsearchInput').value); return false;">
      <noscript>
      <input type="hidden" name="cref" value="http://code.google.com/cse/googlecode-context.xml">
      </noscript>
      <div id="gsc-search-box">
        <input id="gsearchInput" type="text" name="q" maxlength="2048" class="gsc-input" autocomplete="off" title="Google Code Search" style="width:345px">
        <div id="cs-searchresults" onclick="event.cancelBubble = true;"></div>
        <input title="Search" id="gsearchButton" class="gsc-search-button" name="sa" value="Search" type="submit">
        <div class="greytext">e.g. "adwords" or "open source"</div>
      </div>
      </form>
    </div> <!-- end searchForm -->
  </div> <!-- end search -->




</div> <!-- end gc-header -->


<div id="codesiteContent">

<a id="gc-topnav-anchor"></a>
<div id="gc-topnav">
  <h1 style="padding:0 0 0 6px;">Google Maps JavaScript API V2 (<a href="../../../terms.html#section_4_4">Deprecated</a>)</h1>
  <ul id="docs" class="gc-topnav-tabs">

    <li id="home_link">
      <a href="index.html" title="Google Maps JavaScript API V2 home page">Home</a>
    </li>
  
    <li id="docs_link">
      <a href="basics.html" class="selected" title="Official Google Maps JavaScript API V2 documentation">Docs</a>
    </li>
  
    <li id="faq_link">
      <a href="../../../faq.html" title="Answers to frequently asked questions about Google Maps JavaScript API V2">FAQ</a>
    </li>
  
    <li id="articles_link">
      <a href="articles.html" title="Focused articles and tutorials for Google Maps JavaScript API V2 developers">Articles</a>
    </li>
  
    <li>
      <a href="http://googlegeodevelopers.blogspot.com/" title="Official Google Maps JavaScript API V2 blog">Blog</a>
    </li>
  
    <li>
      <a href="forum.html" title="Google Maps JavaScript API V2 developer forum">Forum</a>
    </li>
  
    <li>
      <a href="../../../terms.html" title="Google Maps JavaScript API V2 terms of service">Terms</a>
    </li>
  

  </ul>
</div> <!-- end gc-topnav -->

    <div class="g-section g-tpl-170">

      <a name="gc-toc-anchor"></a>  
      <div class="g-unit g-first" id="gc-toc">
        <ul>
  <li><a href="../../../index.html">Maps API Family</a></li>
  <li><a href="../../../signup.html">Sign up for an API key</a></li>
  <li><a href="http://code.google.com/apis/kml/documentation/kmlSearch.html">Index your Maps Content</a></li>
</ul>
    <div class="line"></div>
    <ul>
      <li><h2>Maps Javascript API V3</h2>
        <ul>
          <li><a href="../index.html">Home Page</a></li>
          <li><a href="../basics.html">Documentation</a></li>
        </ul>
      </li>
    </ul>
       <div class="line"></div>
    <ul>
           <li><h2>Maps Javascript API V2</h2>
         <p><span style="color:grey">(Deprecated API)</span></p>
             <ul>
               <li><a class="tlw-expanded" href="index.html">Developer Guide</a>
                <ul>
                 <li><a href="introduction.html">Basics</a></li>
                 <li><a href="events.html">Events</a></li>
                 <li><a href="controls.html">Controls</a></li>
                 <li><a href="overlays.html">Overlays</a></li>
                 <li><a href="services.html">Services</a></li>
                </ul>
               </li>
              <li><a href="reference.html">API Reference</a></li>
              <li><h2 class="tlw-expanded">Code Samples:</h2>
               <ul>
               <li><a href="demogallery.html">Demos</a></li>
               <li><a href="examples/index.html">Examples</a></li>
               <li><a href="http://code.google.com/apis/ajax/playground/?exp=maps">Code Playground</a></li>
               </ul>
              </li>
              <li><h2 class="tlw-expanded">More Resources:</h2>
               <ul>
               <li><a href="articles.html">Articles</a></li>
               <li><a href="mediagallery.html">Presentations</a></li>
               <li><a href="http://code.google.com/p/gmaps-api-issues/issues/list?can=2&q=apitype%3AJavascript&colspec=ID+Type+Status+Introduced+Fixed+Summary+Internal+Stars&cells=tiles">Known Issues</a></li>
               <li><a href="http://code.google.com/p/gmaps-api-issues/wiki/JavascriptMapsAPIChangelog">Changelog</a><sup class="new">New!</sup></li>
               <li><a href="http://code.google.com/p/gmaps-utility-library-dev/">Utility Library</a></li>
               <li><a href="http://maps.google.com/casestudies/">Case Studies</a></li>
               </ul>
              </li>
             </ul>
           </li>
         </ul>
   <div class="line"></div>
    <ul>
      <li><h2>Maps API for Flash</h2>
        <ul>
          <li><a href="../../flash/index.html">Home Page</a></li>
          <li><a href="../../flash/intro.html">Documentation</a></li>
        </ul>
      </li>
    </ul>
   <div class="line"></div>
    <ul>
      <li><h2>Maps Data API</h2>
        <p><span style="color:grey">(Deprecated API)</span></p>
        <ul>
          <li><a href="../../mapsdata/index.html">Home Page</a></li>
          <li><a href="../../mapsdata/developers_guide_protocol.html">Documentation</a></li>
        </ul>
      </li>
    </ul>
     <div class="line"></div>
      <ul>
        <li><h2><a href="../../webservices/index.html">Maps API Web Services</a></h2>
         <ul>
           <li><a href="../../geocoding/index.html">Geocoding API</a></li>
           <li><a href="../../directions/index.html">Directions API</a></li>
           <li><a href="../../elevation/index.html">Elevation API</a></li>
           <li><a href="../../places/index.html">Places API</a></li>
         </ul>
       </li>
      </ul>
       <div class="line"></div>
        <ul>
          <li><h2>Static Maps API</h2>
            <ul>
              <li><a href="../../staticmaps/index.html">Developer Guide</a></li>
            </ul>
          </li>
        </ul>
    <div class="line"></div>
        <ul>
          <li><h2>Earth API</h2>
            <ul>
              <li><a href="http://code.google.com/apis/earth">Home Page</a></li>
              <li><a href="http://code.google.com/apis/earth/documentation">Documentation</a></li>
            </ul>
          </li>
        </ul>
      <div class="line"></div>
        <ul>
          <li><h2>Local Search API</h2>
            <p><span style="color:grey">(Deprecated API)</span></p>
            <ul>
              <li>
                <a href="../../localsearch/index.html">Home Page</a>
              </li>
              <li>
                <a href="../../localsearch/start.html">Documentation</a>
              </li>
            </ul>
          </li>
        </ul>
    <div class="line"></div>
    <div class="promo"><p><a href="../../premier/index.html">Google Maps API Premier</a></p>
    <p>Same great maps plus a SLA, support, and control over ads</p>
    </div>

      </div>
      
      <a name="gc-pagecontent-anchor"></a>   
      <div class="g-unit" id="gc-pagecontent">
        <h1 class="page_title">Google Maps JavaScript API V2 Events</h1>


<p class="note">Note: The Google Maps Javascript API Version 2
has been officially deprecated as of May 19, 2010. The V2 API will continue
to work as per our <a href="../../../terms.html#section_4_4">deprecation policy</a>,
but we encourage you to migrate your code to
<a href="../index.html">version 3 of the Maps
Javascript API</a>.</p>


<div class="toc">
  <ol>
  <li><a href="#Events_overview">Map Events Overview</a></li>
  <li><a href="#Event_Listeners">Event Listeners</a></li>
  <li><a href="#Event_Closures">Using Closures in Event Listeners</a></li>
  <li><a href="#Event_Arguments">Using Passed Arguments in Events</a></li>
  <li><a href="#Event_Bindings">Binding Events to Objects</a></li>
  <li><a href="#DOM_Events">Listening to DOM Events</a></li>
  <li><a href="#Removing_Event_Listeners">Removing Event Listeners</a></li>
  </ol>
</div>

<h1><a name="Events_overview" id="Events_overview"></a>Map Events Overview</h1>

<p>JavaScript within the browser is <i>event driven</i>, meaning that
JavaScript responds to interactions by generating events, and expects
a program to <i>listen</i> to interesting events. For example, within 
browsers, user mouse and keyboard interactions create
events that propagate within the DOM. Programs interested in
certain events will register JavaScript <b>event listeners</b> for those events
and execute code when those events are received.</p>

<p>The Google Maps API adds to this event model by defining custom events 
for Maps API objects. It is important to note that the Maps API events
are separate and distinct from the standard DOM events. However, as different
browsers implement different DOM event models, the Maps API also provides 
mechanisms to listen for and respond to these DOM events without needing to 
handle the various cross-browser peculiarities.</p>

<h1><a name="Event_Listeners" id="Event_Listeners"></a>Event Listeners</h1>

<p>Events in the Google Maps API are handled by using utility functions
 within the <code>GEvent</code> namespace to register event listeners.
 Each Maps API object exports a 
 number of named events. For example, the <code>GMap2</code> object exports 
 <code>click</code>, <code>dblclick</code>, and <code>move</code> events, 
 and a host of others as well. Each event happens within a given context, 
 and can pass arguments that identify that context. For example, the 
 <code>mousemove</code> event fires when the user moves the mouse 
 within a map object, and passes the <code>GLatLng</code>
of the geographic location in which the mouse is located.</p>

<p>For a complete list of <code>GMap2</code> events and the arguments they generate, see 
<a href="reference.html#Events_GMap">GMap2.Events</a>.</p>

<p>To register for notification of these events, use the static method 
<code>GEvent.addListener()</code>. That method takes an object, 
an event to listen for, and a function to call when the specified 
event occurs. For example, this code snippet shows an alert every time the user 
clicks on the map:</p>

<pre class="prettyprint">
var map = new GMap2(document.getElementById(&quot;map&quot;));
map.setCenter(new GLatLng(37.4419, -122.1419), 13);
GEvent.addListener(map, &quot;click&quot;, function() {
  alert("You clicked the map.");
});
</pre>

<p><a href="examples/event-simple.html">View example (event-simple.html)</a></p>

<h1><a name="Event_Closures" id="Event_Closures"></a>Using Closures in Event Listeners</h1>

<p>When executing an event listener, it is often advantageous to have both private and persistent 
data attached to an object. JavaScript does not support "private" instance data, but it does
support <a href="http://www.jibbering.com/faq/faq_notes/closures.html" rel="nofollow">closures</a>
which allows inner functions to access outer variables. Closures are useful within event
listeners to access variables not normally attached to the objects on which events occur.</p>

<p>The following example uses a function closure in the event listener to assign a secret 
message to a set of markers. Clicking on each marker will review a portion of the
secret message, which is not contained within the marker itself.</p>

<pre class="prettyprint">
var map = new GMap2(document.getElementById(&quot;map_canvas&quot;));
map.setCenter(new GLatLng(37.4419, -122.1419), 13);

// Creates a marker at the given point
// The five markers show a secret message when clicked
// but that message is not within the marker's instance data

function createMarker(point, number) {
  var marker = new GMarker(point);
  var message = ["This","is","the","secret","message"];
  marker.value = number;
  GEvent.addListener(marker, &quot;click&quot;, function() {
    var myHtml = &quot;&lt;b&gt;#&quot; + number + &quot;&lt;/b&gt;&lt;br/&gt;&quot; + message[number -1];
    map.openInfoWindowHtml(point, myHtml);
  });
  return marker;
}

// Add 5 markers to the map at random locations
var bounds = map.getBounds();
var southWest = bounds.getSouthWest();
var northEast = bounds.getNorthEast();
var lngSpan = northEast.lng() - southWest.lng();
var latSpan = northEast.lat() - southWest.lat();
for (var i = 0; i < 5; i++) {
  var point = new GLatLng(southWest.lat() + latSpan * Math.random(),
    southWest.lng() + lngSpan * Math.random());
  map.addOverlay(createMarker(point, i + 1));
}
</pre>

<p><a href="examples/event-closure.html">View example (event-closure.html)</a></p>

<h1><a name="Event_Arguments" id="Event_Arguments"></a>Using Passed Arguments in Events</h1>

<p>Many events in the Maps API event system pass arguments when the event
is triggered. For example, the <code>GMap2</code> "click" event passes an
<code>overlay</code> and <code>overlaylatlng</code>
if the map click occurs on an overlay; otherwise, it passes a
<code>latlng</code> of the map coordinate. You can access these arguments 
by passing the specified symbols directly to the functions
within the event listeners.</p>

<p>In the example below, we first test to ensure the click was on a map tile
by checking if the <code>latlng</code> argument is defined; if so, we open 
an  info window above the clicked coordinate and display the coordinate 
converted to pixel space along with the zoom level.</p>

<pre class="prettyprint">
var map = new GMap2(document.getElementById("map_canvas"));
map.setCenter(new GLatLng(37.4419, -122.1419), 13);

GEvent.addListener(map,"click", function(overlay, latlng) {     
  if (latlng) { 
    var myHtml = "The GPoint value is: " + map.fromLatLngToDivPixel(latlng) + " at zoom level " + map.getZoom();
    map.openInfoWindow(latlng, myHtml);
  }
});
map.addControl(new GSmallMapControl());
map.addControl(new GMapTypeControl());
</pre>

<p><a href="examples/event-arguments.html">View example (event-arguments.html)</a></p>

<h1><a name="Event_Bindings" id="Event_Bindings"></a>Binding Events to Objects</h1>

<p>Events typically act directly on the object receiving the event. For example, if 
you attach a <code>'click'</code> event listener to a <code>GMap2</code> object, 
you usually call methods on the map itself within the event listener's
attached function.</p>

<p>You can test this behavior within your code by replacing
a reference to the object to <code>this</code>; if the event listener acts on the object
receiving the event, both <code>this</code> and the object reference are equivalent.</p>

<pre class="prettyprint">
# The following event listeners are equivalent:

# Access the map using the 'map' symbol
var map = new GMap2(document.getElementById(&quot;map&quot;));
GEvent.addListener(map, &quot;moveend&quot;, function() {
  var center = map.getCenter();
  document.getElementById(&quot;message&quot;).innerHTML = center.toString();
});

# Access the map using the 'this' keyword
var map = new GMap2(document.getElementById(&quot;map&quot;));
GEvent.addListener(map, &quot;moveend&quot;, function() {
  var center = this.getCenter();
  document.getElementById(&quot;message&quot;).innerHTML = center.toString();
});

</pre>

<p>If instead, you wish to invoke a method on a separate object in response to 
events, you can use <code>GEvent.bind()</code> to bind a method to a different object
than the one receiving the event.</p>

<p>In the following example, the event listener binds map <code>'click'</code> 
events to an instance of the <code>Counter</code> object, and invokes a method
defined within that object:</p>

<pre class="prettyprint">
function initialize() {
  if (GBrowserIsCompatible()) {
    var map = new GMap2(document.getElementById("map_canvas"));
    var myCounter = new Counter();
    map.setCenter(new GLatLng(37.4419, -122.1419), 13);
    GEvent.bind(map, "click", myCounter, myCounter.increment);
  }
}
    
function Counter() {
  this.counter = 0;
}
    
Counter.prototype.increment = function() {
  this.counter++;
  alert("You have clicked the map " + this.counter +
        (this.counter == 1 ?" time":" times"));
}
</pre>

<p><a href="examples/event-bind.html">View example (event-bind.html)</a></p>

<h1><a name="DOM_Events" id="DOM_Events"></a>Listening to DOM Events</h1>

<p>The Google Maps API event model creates and manages its own custom events.
However the DOM also creates and dispatches its own events, according
to the particular browser event model in use. If you wish to capture and respond
to these events, the Google Maps API provides browser-neutral wrappers to listen 
and bind DOM events, without the need for custom code.</p>

<p>The <code>GEvent.addDomListener()</code> static method registers an
event handler for a DOM event on a DOM node. Similarly, the
static method <code>GEvent.bindDom()</code> allows you to register
event handlers for DOM events on class instances.</p>

<h1><a name="Removing_Event_Listeners" id="Removing_Event_Listeners"></a>
Removing Event Listeners</h1>

<p>When an event listener is no longer needed, you should remove it. This
might even be needed in cases where the event should only be fired once.
Removing event listeners that were defined via anonymous functions within
closures can be difficult. However, the <code>addListener()</code>,
<code>addDomListener()</code>, <code>bind()</code>, and <code>bindDom()</code>
functions return a <code>GEventListener</code> handle, which
can be used to eventually deregister the handler.</p>

<p>The following example responds to a click by placing a marker on the 
map. Any subsequent click removes the event listener. Notice that the <code>removeOverlay()</code>
code is never executed as a result. Also, notice that you can remove
an event listener even from within the event listener itself.</p>

<pre class="prettyprint">
function MyApplication() {
  this.counter = 0;
  this.map = new GMap2(document.getElementById(&quot;map&quot;));
  this.map.setCenter(new GLatLng(37.4419, -122.1419), 13);
  var myEventListener = GEvent.bind(this.map, &quot;click&quot;, this, function(overlay, latlng) {
    if (this.counter == 0) {
      if (latlng) {
        this.map.addOverlay(new GMarker(latlng))
        this.counter++;
      } else if (overlay instanceof GMarker) {
        this.removeOverlay(marker)
      }
    } else {
      GEvent.removeListener(myEventListener);
    }
  }); 
}

function load() {
  var application = new MyApplication();
}
</pre>

<p><a href="examples/event-removal.html">View example (event-removal.html)</a></p>
        <!-- end body text -->

   
      </div><!-- end gc-pagecontent -->
   </div><!-- end gooey wrapper -->

    </div> <!-- end codesite content -->


<div id="gc-footer" dir="ltr">
  <div class="text">
    
    &copy;2010 Google -
    <a href="http://code.google.com">Code Home</a> -
    <a href="http://code.google.com/terms.html">Terms of Service</a> -
    <a href="http://code.google.com/privacy.html">Privacy Policy</a> -
    <a href="http://code.google.com/more">Site Directory</a>
    <br> <br>
    Google Code offered in:
    <a href="http://code.google.com/intl/en">English</a> -
    <a href="http://code.google.com/intl/es">Español</a> -
    <a href="http://code.google.com/intl/ja">日本語</a> -
    <a href="http://code.google.com/intl/ko">한국어</a> -
    <a href="http://code.google.com/intl/pt-BR">Português</a> -
    <a href="http://code.google.com/intl/ru">Pусский</a> -
    <a href="http://code.google.com/intl/zh-CN">中文(简体)</a> -
    <a href="http://code.google.com/intl/zh-TW">中文(繁體)</a>
  </div>
</div><!-- end gc-footer -->

</div><!-- end gc-container -->

<script type="text/javascript">CODESITE_CSITimer['load'].tick('ats');</script>
<script src="../../../../../js/codesite_tail.pack.04102009.js" type="text/javascript"></script>




<script type="text/javascript">
var _gaq = _gaq || [];

_gaq.push(


    ['siteTracker._setAccount', 'UA-18071-1'],
    ['siteTracker._setDomainName', 'code.google.com'],
    ['siteTracker._setCookiePath', window.location.pathname.substring(0,
        window.location.pathname.lastIndexOf('/') + 1)],
    ['siteTracker._trackPageview']
);
(function() {
  var ga = document.createElement('script');

  ga.type = 'text/javascript';
  ga.async = true;
  ga.src = 'http://www.google-analytics.com/ga.js';
  (document.getElementsByTagName('head')[0] ||
   document.getElementsByTagName('body')[0]).appendChild(ga);
 })();
</script>




  </body>
</html>

