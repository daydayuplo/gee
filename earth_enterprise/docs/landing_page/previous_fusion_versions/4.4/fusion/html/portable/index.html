<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<link rel="stylesheet" type="text/css" href="../css/dev_docs2.css" />
<link rel="stylesheet" type="text/css" href="local_extensions.css" />
<!--[if IE]>
  <link rel="stylesheet" type="text/css" href="iehacks.css" />
<![endif]-->
<title>Google Earth Enterprise Portable Globe and Server</title>
</head>

<body>
<a name="top"></a>
  
<!-- BEGIN HEADER -->
<div id="header">
  <div id="logo">
    <img alt="Google Earth Enterprise" border=0 src="images/index.gif" />
  </div>
  <h1 id="doc_title">Portable Globe and Server</h1>
</div>
<!-- END HEADER -->

<!-- BEGIN WRAPPER -->
<div id="wrapper">

<!-- BEGIN LEFT NAV BAR -->
<div id="sidenav">

  <ul>
    <li><a href="../../../index.html">4.4.1 Documentation</a></li>
    <div class="line"></div>
    <li><a href="index.html" id="selected"><strong>Portable Globe and Server</strong></a></li>
    <li><a href="search_tabs.html">Using Search Tabs with the
      Portable Server
    </a></li>
    <div class="line"></div>
    <li><a href="notices.html">Legal Notices</a></li> 
  </ul>

</div>
<!-- END LEFT NAV BAR -->

<!-- BEGIN PAGE CONTENT -->

<div id="pagecontent">
<h1></h1>
<ol class="toc">
  <li><a href="#overview">Overview</a></li>
  <li><a href="#installation">Installation</a></li>
  <li><a href="#creating_a_portable_globe">Creating a portable globe</a></li>
  <li><a href="#portable_server">Portable server</a></li>
  <li><a href="#connecting">Connecting to a portable globe</a></li>
  <li><a href="#glb">Usage of the Apache (glc) Module</a></li>
  <li><a href="#command_line_reference">Command line reference</a><br />
  </li>
</ol>

<h2 id="overview">Overview</h2>
<p>The Google Earth Enterprise Portable Server solution enables organizations to access portions of their custom globes in the field when no network access may be available or possible. Using a web interface, end-users may select an area of interest to download from a Google Earth Enterprise Server for offline use on their Mac or Windows laptop with the Portable Server application.</p>
<p>All data available within a specified area of interest is downloaded and stored in  a portable globe, including all high-resolution imagery, terrain, vector data, KML files, and searchable Point of Interest (POI) locations. Outside of the specified area of interest, only low resolution imagery and terrain will be stored in a portable globe. These levels of resolution can be specified when the globe is cut.</p>
<p>Portable globes may be specified, generated, and downloaded in as quickly as a few minutes -- depending on the area of coverage -- to support rapid preparation for first responders, or larger globes may be built in advanced preparation for responders to have ready “on the shelf.”</p>
<p><img src="images/gee_portable_diagram.gif" /></p>

<p>The Portable Server solution is made up of two applications:</p>
<ul>
  <li>The <a href="#globe_cutter">globe cutter</a> tool, which is installed on a production Google Earth Enterprise Server system hosting a 3D database. This tool allows end-users and administrators to select, package, and download a portion of the 3D Earth as a portable globe file.</li>
  <li>The <a href="#local_server">portable  server</a>    is installed  on Windows or Mac OS X  machines in the field.  It can operate in a single-user mode for complete offline usage by one user, or can broadcast a portable globe so that multiple Portable Server users, and/or mobile users with compatible Android-based smart phones, can view the same globe. </li>
  </ul>
<p class="note">Note: The Portable Server solution can also create portable globes from a 2D map
  source. This document uses the term <em>portable globe</em> only, but instructions apply
  to both globes and maps.<br />
</p>
<h2 id="installation">Installation</h2>
<p>This section describes installation of the two applications that make up  the Portable
  Server solution:</p>
<ol class="toc">
  <li><a href="#globe_cutter">Globe cutter installation</a></li>
  <li><a href="#portable_globe_server">Portable globe server installation</a></li>
</ol>

<h3 id="globe_cutter">Globe cutter installation</h3>
<p>The portable globe cutter tool is installed with Google Earth Enterprise Server 4.2 (and later). Globe cutting is disabled by default; to enable it you must set the <code>--enable_cutter</code> flag for <code>geserveradmin</code> from the command line:</p>
<pre># geserveradmin --enable_cutter</pre>
<p>By default, the cut globes will be stored in the <code>/opt/google/gehttpd/htdocs/cutter/globes</code> directory.
  The cut globes can be large, and many servers do not have sufficient storage allocated
  in this directory for multiple globes. If this is the case for your server, please
  contact tech support or visit the Earth Enterprise user forum for instructions
  on designating a different directory as the storage area for the cut globes.</p>

<h3 id="portable_globe_server">Portable globe server installation</h3>

<p>The portable server is supported on:
<li>Windows XP and 7
<li>Windows 2008 Server
<li>Mac OS X 10.4 and up.
</p>
<h4>Windows</h4>
<p>To download the portable server installer, please contact Google Enterprise Support. Once you've obtained the installer:</p>
<ol>
  <li>Copy the installer to the Windows machine(s) on which you'd like to install the portable server.</li>
  <li>Double-click the executable file, and follow the prompts to install. Once installed,
    a shortcut labeled <strong>Google Earth Portable</strong> will be present on your desktop.
    Double-click that shortcut to launch the server.
  </li>
</ol>
<p>The program files are installed  into:</p>
<pre>C:\Program Files\Google\Google Earth Portable Server\Portable\</pre>
<p>The data files are installed  into:</p>
<pre>C:\Program Files\Google\Google Earth Portable Server\Portable\Data\</pre>
<p>The default path may vary between Windows versions; different paths for the program and data can be specified
  at the time of installation.</p>
<p>For Windows 7, user can choose Per-User or Per-Machine Installations by selecting "Anyone who uses this computer (all users)" or "Only for me (username)" button. Per-machine installation requires admin rights. Only Per-machine installation is available for Windows XP</p>

<h4>Mac OS X</h4>
<p>To download the portable server installer, please contact Google Enterprise Support. Once you've obtained the installer:</p>
<ol>
  <li>Copy the <code>Google_Earth_Portable.dmg</code> file to the OS X machine(s) on which you'd like to install the portable server.</li>
  <li>Mount the disk image by double-clicking the <code>.dmg</code> file, then open the image in Finder by double-clicking the mounted drive on your desktop.</li>
  <li>Drag the <strong>Google Earth Portable</strong> folder into your <strong>Applications</strong> folder.</li>
  <li>To launch the server, select the <strong>Google Earth Portable</strong> shortcut inside that folder.</li>
</ol>
<h2 id="creating_a_portable_globe">Creating a portable globe</h2>

<p>Cutting a globe is accomplished with a simple web interface. You'll use your
  mouse, or import KML, to define a polygon, which defines your 'area of interest.'
  This polygon not only defines the area that will display high-resolution imagery,
  but is also used by Fusion to create a localized search database.</p>
<ol class="toc">
  <li><a href="#before_you_begin">Before you begin</a></li>
  <li><a href="#the_cutter_interface">The cutter interface</a></li>
  <li><a href="#globe_name">Globe name</a></li>
  <li><a href="#drawing_the_polygon">Drawing the polygon</a></li>
  <li><a href="#globe_resolution">Globe resolution</a></li>
  <li><a href="#building_the_globe">Building the globe</a></li>
</ol>
<table width="80%" class="table_note">
  <tr>
    <td><p><strong>Note</strong>: The globe cutting processes are CPU and disk intensive, as they are retrieving all data within the specified polygon from the Earth Enterprise Server. This can affect the overall performance of the Server, including slowing end-user access. </p>
      <p>To mitigate performance impact to end users, you may consider:      </p>
      <ul>
        <li>Limiting the number of users with access to globe cutting.</li>
        <li>Creating pre-cut portable globes to host as  downloadable files for portable users.</li>
        <li>Operating a separate GEE Server specifically to support on-demand globe cutting needs.</li>
      </ul>
      <p>Please contact the Google Earth Enterprise Support team for further information or questions about these procedures. </p></td>
  </tr>
</table>

<h3 id="before_you_begin">Before you begin</h3>
<ol class="toc">
  <li></li>
  </ol>
<h4 id="enable_the_cutter">Enable the cutter</h4>
<p>Before cutting a globe, you must enable the cutter from the command line:</p>
<pre># geserveradmin --enable_cutter </pre>

<p>For more information about <code>geserveradmin</code>, please refer to the <strong>Command Line Reference</strong> chapter of the <strong>Reference Guide</strong>.</p>
<p class="warning"><strong>Note about authentication and SSL</strong>: Cutting is not currently supported on globes that require end-user authentication e.g. LDAP.  One workaround is to allow unauthenticated access from localhost on your Earth Enterprise Server.  (Contact Google Enterprise Support if you need sample Apache directives to enable such a configuration.)
Cutting of a globe over HTTPS is supported; however the SSL certificate of the target server will not be verified during cutting. </p> 
<h4 id="install_the_google_earth_plugin">Install the Google Earth Plugin</h4>
<p>The Google Earth Plugin is used to display the globe from which maps are cut.
  To install the plugin, visit <strong>http://developers.google.com/apis/earth</strong> and follow the prompts
  inside the Google Earth Plugin frame.  If you require installers for offline installation, contact Google Enterprise Support.</p>
<h3 id="the_globe_cutter_interface">The globe cutter interface</h3>
<p>To create a portable globe, point your browser to <code>http://yourserver/cutter</code>,
  where <code>yourserver</code> is the server on which Earth Enterprise Server is
  running. The <strong>Globe Creator</strong> page appears.</p>
<img src="images/cutter_interface.png" />
<p>Select the globe you'd like to cut your portable version from in the drop-down menu.</p>

<p class="note">Note: An alternate cutter UI is available at <code>http://yourserver/cutter/globe_cutter_advanced.html</code>.  This interface offers additional globe-cutting options, namely <em>Polygon Resolution</em>. This setting is useful when cutting with large polygons; e.g. use 12 for a country-sized polygon and 18 for a city-sized polygon.  Additional advanced settings may be offered in future versions.  Use caution when changing them as they may dramatically increase build times and globe sizes.</p>

<h3 id="globe_name">Globe name</h3>
<p>The globe name defines the filename of this globe; it will be created as a <code>.glb</code> file,
  which is a single-file format for sharing Google Earth Enterprise globes. Spaces,
  slashes, and double dots (..) will be converted to underscores in the saved globe
  name.</p>
<p>We recommend using
  a descriptive name for each globe, so that others will know what geographic area, or
  what mission, the globe was created for.</p>
<p class="warning"><strong>Note</strong>: Building a globe will overwrite any existing globes with the same name. If multiple users are cutting globes, we recommend assigning unique prefixes to each user for their globe names to ensure that files are not accidentally overwritten.</p>

<h3 id="drawing_the_polygon">Drawing the polygon</h3>
<p>Once the globe name has been specified, you can define the geographic region to
  be cut, by drawing a polygon on the globe. There are two ways to draw the polygon.</p>
<h4>Hand drawing the polygon</h4>
<p>First, using the navigation controls in the plugin, zoom in to the region of interest.
  To use your mouse to define the polygon, click the polygon icon in the globe window:
  <br />
  <img src="images/polygon_icon.png" /></p>
<p>Then, click on the globe to define each point. You can use the navigation controls
  on the right to move the globe or change zoom levels while drawing.</p>
<p>Double-click the final point to complete the polygon selection, at which point the polygon should change from blue to purple.</p>
<p>You can view the KML of the shape you've drawn by selecting the  
  
  <strong>Enter polygon as KML</strong> checkbox.</p>
<h4>Defining the polygon with KML</h4>
<p> You can also use KML to define the polygon(s). The KML should be complete, and may contain single or multiple <code><Polygon></code> elements.  To insert your KML:</p>
<ol>
  <li> Select the 
    <strong>Enter polygon as KML</strong> checkbox.</li>
  <li> Paste your KML into the text field.</li>
  <li> Click outside of the text field. Your polygon appears on the map.<br />
  </li>
</ol>

<h3 id="globe_resolution">Globe resolution</h3>
<p>The polygon you specify in the previous step defines your 'area of interest.'
  This area will contain high-resolution imagery and data, and search tabs will be
  created for information that lies within this zone. The maximum and minimum resolutions
  are specified as integers between 1 and 24. These correspond to the zoom levels
  that are used in the Fusion server.</p>
<h4>Minimum resolution</h4>
<p> The zoom level for the polygon area is specified in the <strong>Maximum resolution
    to extract</strong> field.</p>
<p>A minimum
  zoom level of 5-7 will present a decent-looking world to the user and will most
  likely include vector layers such as international boundaries and state boundaries
  and main cities without affecting the size of the <code>.glb</code> file very much.
  For example:</p>
<ul>
  <li>A cut globe with minimum and maximum resolution values set to 5 is 10MB.</li>
  <li>A cut globe with minimum and maximum resolution values set to 6 is 41MB.</li>
  <li>A cut globe with minimum and maximum resolution values set to 7 is 120MB.</li>
  </ul>
<p>These numbers are small in comparison to the overall size of your globe when a
  suitable maximum resolution has been selected. For example, a globe that contains
  all of the city of Atlanta, GA, USA in 1-foot resolution requires approximately
  5GB of storage. Even level 7 imagery, at 120MB, is a small percentage of the overall
  globe size.</p>
<h4>Maximum resolution</h4>
<p>The area outside of the defined polygon will be included in the globe at a lower
  resolution, which is defined within the <strong>Minimum resolution to extract</strong> field.
  Areas near the polygon may be included at a higher resolution.</p>
<p>The maximum resolution of the cut globe will be no higher than the maximum resolution
  of the source globe. For example, if the maximum resolution in the cutter is specified
  at 24, but the source imagery is at 18 (approximately 1-meter resolution), the
  cut globe will contain level
  18 imagery. You can leave this field blank to use the highest available imagery.</p>
<p>You may enter a lower number to reduce the size of your globe, by not including
  the highest resolution imagery.</p>

<h3 id="building_the_globe">Building the globe</h3>
<p>Click <strong>Build</strong> to start the build process. Depending on the size of your polygon, this can take from a few minutes to a few hours; likewise, file size will vary widely depending on the area selected and the desired resolution.</p>
<p>  When the build is finished, a <code>.glb</code> file is created and a download
  link appears to the file's location on the Earth Server. Save the file into the
  <code>Portable\Data</code> directory with the other <code>.glb</code> files.
  Alternately, the globe file can be copied onto portable media like a DVD, thumb
  drive, or external hard drive to be delivered to users.</p>
<p>The <code>.glb</code> file
  contains all that you need to share your portable globe - imagery, terrain, and
  vector assets, plus the search database. For this reason, it's important to retain
  control of your globe if it contains sensitive or proprietary information.</p>
<h4>Search tabs</h4>
<p>When a globe is cut, the search tabs associated with the globe are also bundled
  with the globe. However, because search plugins in Google Earth Enterprise run
  within the Tomcat / Apache instance on the Earth server, most search tabs will
  not work
  in a portable globe.</p>
<p>The Portable Server uses its own search framework that allows Python code stored
  on the portable machine to execute in place of the GEE plugin.</p>
<p>For more
  information, please refer to <a href="search_tabs.html">Using Search Tabs with
    the Portable Server</a>.</p>
<h4>KML files</h4>
<p>When a portable globe is cut from a source containing KML links in the Layer panel:</p>
<ul>
  <li>  KML files that are  stored locally on the primary Earth Server will be bundled
    into the portable globe. Only the main KML file will be copied, not any links
    or files that are embedded as links in the main KML file. The default copy is
    not recursive.</li>
  <br />
  <li>KML links that refer to servers other than the primary Earth Server are not
    copied. The layer will be visible in the client, but clicking  the link will
    not cause any data to be displayed. If access to external servers is needed,
    a small KML file should be stored locally on the primary Earth Server. This KML
    file should contain a link to the intended external server.
  </li>
</ul>
<p>These behaviors can be modified if the globe is built from the command line rather
  than from the GUI as described in the <a href="#command_line_reference">Command
  line reference</a> section of this document. </p>
<h4>Historic Imagery</h4>
<p> Historic Imagery is not supported in the portable globe as of Fusion 4.2. It
  is being investigated as a possible feature.</p>
<p>There are, however, two situations in which historic imagery will be displayed:</p>
<ul>
  <li>When the computer running the portable globe has a connection to the Earth
    server from which the globe was cut. In this case, historic imagery can be streamed
    from the Earth server. Once in the field, however, and disconnected from the
    Earth server, no historic imagery will be displayed.</li><br />
  <li>If historic imagery has been cached on the portable globe machine.</li>
</ul>
<p>If the portable globe's computer has a connection to the
  original Earth server from which the globe was cut, </p>
<p>Otherwise, the following error message will appear:</p>
<blockquote>
  <p class="note"><strong>Google Earth can't contact the imagery server to download new images.</strong><br />
    You'll be able to see areas that you've been to recently, but new image areas may
    appear blurry.
  </p>
</blockquote>

<h2 id="portable_server">Portable server</h2>
<p>The portable server is a  lightweight web server that runs on OS X
  or Windows computers. The web server starts within seconds and begins serving
  one of the globes that has been saved to the Data directory. Once the globe is served,
  a web browser is automatically launched.</p>
<ol class="toc">
  <li><a href="#serving_a_globe">Serving a globe</a></li>
  <li><a href="#broadcasting_a_globe">Broadcasting a globe</a></li>
  <li><a href="#changing_the_globe_being_served">Changing the globe being served</a></li>
</ol>
<h3 id="serving_a_globe">Serving a globe</h3>
<p>Copy the globe to be served into the <code>Data</code> subdirectory (or whichever directory is specified as the <code>globes_directory</code> in <code>portable.cfg</code>).</p>

<ol>
  <li> <strong>Windows</strong>: Double-click the <strong>Google Earth Portable</strong> desktop shortcut  created during installation.
    <p><strong>Mac OS X</strong>: From the <strong>Applications</strong> folder, open the <strong>Google Earth Portable</strong> folder and double-click<strong> Google Earth Portable</strong>.</p>
    <p>All of the globes present in the globe directory are listed and available for serving.</p>
  </li>
  <li>Click <strong>start serving</strong> next to the globe you wish to serve.</li>
</ol>
<p>To stop serving a globe, return to the administration page at <code>http://localhost:9335</code>. The currently-served globe is listed in the first section; click <strong>stop serving</strong> to stop serving that globe.</p>

<h3 id="broadcasting_a_globe">Broadcasting a globe</h3>
<p>To share a globe with others on your network:</p>

<ol>
  <li>If you're not already serving a globe, double-click the globe file, or select the globe to serve from the Portable Server interface.</li>
  <li>In the <strong>Currently serving</strong> section of the Portable Server interface, click <strong>broadcast</strong>.</li>
  <li>Enter a <strong>Key</strong> value and click <strong>Set Key</strong>. This key is simply an access key; it is not an encryption key.</li>
  <li>In the <strong>Remote servers</strong> section, click <strong>add</strong>.</li>
  <li>The <strong>Currently serving</strong> section now shows that you are <strong>Broadcasting</strong>. Click <strong>glr</strong> to create a connection file for this globe.
    <p><img src="images/portable_glr.png" /></p>
  </li>
  <li>A <code>share.glr</code> file is created and saved to your browser's default download directory. This file can be sent to any user who requires a connection to your globe; the remote client must also be installed on their machine.</li>
</ol>

<h3 id="changing_the_globe_being_served">Changing the globe being served</h3>
<p>To change the globe being served:</p>
<ul>
  <li>Point your browser to <a href="http://localhost:9335">http://localhost:9335</a> and click <strong>start serving</strong> for your new globe.<br />
    <br />
    Or, </li>
  <br />
  <li>Double-click the globe file from your system.</li>
</ul>
<p>If you're accessing the globe with the Google Earth Enterprise Client, log out of the client and logback in to <code>http://localhost:9335</code>.</p>
<h2 id="connecting">Connecting to a portable globe</h2>
<p>It's possible to connect to a portable globe from a variety of platforms.</p>
<ol class="toc">
  <li><a href="#google_earth_ec">Google Earth EC</a></li>
  <li><a href="#google_earth_api">Google Earth API</a></li>
  <li><a href="#connecting_to_a_broadcasted_globe">Connecting to a broadcasted globe</a></li>
  <li><a href="#portable_cfg">Defining options in portable.cfg</a></li>
</ol>
<h3 id="google_earth_ec">Google Earth EC</h3>
<p>Launch the Google Earth EC client. When prompted for a server address, enter <code>http://localhost:9335</code>. If you've changed the default port in portable.cfg, use the new port value instead.</p>

<h3 id="google_earth_api">Google Earth API</h3>
<p>The Google Earth Enterprise Portable Server comes with a preconfigured HTML page that displays your globe using the Earth API. This page is at <code>http://localhost:9335/earth/earth_local.html</code>.</p>
<p>If you'd like to make your own custom Earth API application, make a copy of the included file from which to start.</p>
<p>You can also reach the page listed above by clicking <strong>view in browser</strong> from the administration page at <code>http://localhost:9335</code>.</p>
<h3 id="connecting_to_a_broadcasted_globe">Connecting to a broadcasted globe</h3>
<p>The Portable server uses connection files to simplify connections to broadcasted globes. The individual with access to the globe file serves that globe on their local machine, then creates the connection file containing the machine address and connection parameters.</p>
<p>To connect to a broadcasted globe, you can:</p>
<h4>Connect with a .glr file</h4>
<p>If you've been sent a <code>.glr</code> file, simply double-click the file to launch your portable server and connect to the broadcasted globe. You must have the portable server already installed.</p>
<h4>Create your own connection file</h4>
<p>If you don't have the <code>.glr</code> connection file for a globe, but know the machine address and broadcast key, you can create your own connection file:</p>
<ol>
  <li>Start the portable server.</li>
  <li>In the Remote servers section, click <strong>add</strong>.</li>
  <li>Enter the following information:
    <p><strong>Name</strong>: The filename for this server connection file. A .glr extension
      will be appended to this name when the file is created.<br />
      <strong>Server</strong>: The IP address or machine name on which the portable server is running.<br />
      <strong>Port</strong>: The default port is <code>9335</code>. If you're serving on another port, enter that number here.<br />
      <strong>Key</strong>: The access key for this server.</p>
    <p><img src="images/remote_new.png" /></p>
  </li>
  <li>Click <strong>Add Server</strong>. A .glr file is created and saved to your globes directory. It will also show up in the <strong>Remote servers</strong> section of the Portable Server interface.</li>
  </ol>
<h3 id="portable_cfg">Defining options in portable.cfg </h3>
<p>The <strong>Tools</strong> directory (<code>.apps</code> on OS X) in the portable
  server folder hierarchy contains the main configuration file, <code>portable.cfg</code>.
  This file defines a number of options, but is primarily used to change the port
  on which the globe is served, if required.</p>
<ul>
  <li><strong>port</strong>: defines the port on which to serve the globe. Default
    is 9335.</li>
  <li><strong>globes_directory</strong>: the directory in which to look for globe
    files.</li>
  <li><strong>globe_name</strong>: the default globe to serve when the server is
    started.</li>
  <li><strong>fill_missing_map_tiles</strong>: If set to 'True', enables pixel-filling from ancestor map tile when there are no more tile descendents.</li>
  <li><strong>max_missing_maps_tile_ancestor</strong>: Limit the pixelation to 2<sup>x</sup> by 2<sup>x</sup> sized pixels.</li>
  <li><strong>local_override</strong>: If set to 'True', Portable Server looks for all files on the server first before seeking them on the globe.</li>
</ul>
<h4>Changing the port </h4>
<p>When changing the port from the default, you should re-cut your globe for the
  new port number as well. To do so, you must override the default port parameter
  in the cutter:</p>
<ol>
  <li> On your cutter server, open <code>/opt/google/gehttpd/htdocs/cutter/js/globe_cutter.js</code> </li>
  <li>Find these lines:
    <pre>// Example:
// var FORCE_ARGUMENTS = '&amp;FORCE_PORTABLE_PORT=8778';
var FORCE_ARGUMENTS = ''; </pre>
  </li>
  <li>Uncomment the second line, and update the port number. Then, comment out the
    third line. You will end up with:
    <pre>// Example:
var FORCE_ARGUMENTS = '&amp;FORCE_PORTABLE_PORT=3209';
// var FORCE_ARGUMENTS = '';</pre>
  </li>
</ol>
<p>&nbsp;</p>
<h2 id="glb">Usage of the Apache (glc) Module</h2>
<p>The Google Earth Enterprise Apache (glc) module supports a mechanism to serve .glb files from a Google Earth Enterprise Server 4.2.0 (or later).  This functionality provides an on-premise alternative to serving a .glb and .glc file from the Portable Server.</p> 
<h4>Setup</h4> 
<ol>
  <li> Enable the cutter (even if it was done so previously):
    <pre>sudo /opt/google/bin/geserveradmin --enable_cutter</pre>
  </li>
  <li> Verify <code>/opt/google/gehttpd/conf.d/gemodules.conf</code> contains:
    <pre>LoadModule glc_module /opt/google/gehttpd/modules/mod_glc.so</pre>
  </li>
  <li> Verify <code>/opt/google/gehttpd/conf.d/virtual_servers/default_glc.location</code> exists and contains:
    <pre>&lt;Location /portable/ &gt;
  SetHandler glc-handler
  Include conf.d/virtual_servers/runtime/default_glc_runtime
&lt;/Location&gt;</pre>
  </li>
  <li> Verify <code>/opt/google/gehttpd/conf.d/virtual_servers/runtime/default_glc_runtime</code> contains:
    <pre>Glc "/opt/google/gehttpd/htdocs/cutter/globes"</pre>
  </li>
  </ol>
<h4>Access</h4>
<p>To load the glb in Google Earth Enterprise Client (EC), connect to the server using the following URL syntax:
  <pre>http://&lt;your_server&gt;/portable/&lt;your_globe.glb&gt;</pre></p>
<p>To load the glb or glm in the default application using the Google Earth API Browser Plugin:
  <pre> http://&lt;your_server&gt;/earth/glb.html?map=/portable/&lt;your_globe&gt;.glb
 http://&lt;your_server&gt;/maps/glm.html?map=/portable/&lt;your_map&gt;.glm</pre></p>
<p>To load the glb in a custom Javascript application using the Google Earth API Browser Plugin, reference the same path when <a href="http://developers.google.com/earth/documentation/reference/google_earth_namespace.html#a70288485024d8129dd1c290fb2e5553b">creating</a> the plugin instance, e.g.
  <pre>google.earth.createInstance('earth', initCB, failureCB, {database:'http://&lt;your_server&gt;/portable/&lt;your_globe.glb&gt;'});</pre>
</p>

<h4>Metadata</h4>
<p>To view more information about a particular .glb, including what other globes have been served since the last time the server was restarted, enter the following URL:</p>
<pre>http://&lt;your_server&gt;/portable/&lt;your_globe.glb&gt;/statusz</pre>
</p>The output should look similar to:</p>
<pre><strong>Glc Apache Module Status</strong>
<strong>Globe my_globe.glb</strong>
Size: 13.35 MB (13353414 bytes)

<strong>Unpacker Map Globes (3)</strong>
   /usr/local/google/globes/Atlanta.glb
   /usr/local/google/globes/SF.glb
   /usr/local/google/globes/my_globe.glb
</pre>
<p>If the list of globes is too long or stale (i.e. many of the globes are no longer being accessed), restart the server to refresh the information or improve performance.<p>

<h2 id="command_line_reference">Command line reference</h2>

<p>The following command line tools are available for the portable globe and server.</p>
<ol class="toc">
  <li><a href="#gepolygontoqtnodes">gepolygontoqtnodes</a></li>
  <li><a href="#gerewritedbroot">gerewritedbroot</a></li>
  <li><a href="#gekmlgrabber">gekmlgrabber</a></li>
  <li><a href="#geportableglobebuilder">geportableglobebuilder</a></li>
  <li><a href="#geportableglobepacker">geportableglobepacker</a></li>
  </ol>
<p>Knowledge of these command line tools is not needed for most users and system
  administrators. The simple cutter interface that is provided should meet the needs
  of nearly all users. However, if finer control is needed or if the complete creation
  of globes needs to be automated, these command line tools are available. The following
  is the series of events for creating a globe to help give a sense of what
  these command line tools accomplish and in what order they are run:</p>
<pre>
Building LevelFive ...

No description given.
Added globe directory: /tmp/globe_builder/LevelFive_4282_1287494655.545115/LevelFive Ok

Saved polygon to /tmp/globe_builder/LevelFive_4282_1287494655.545115/LevelFive/earth/polygon.kml
Convert polygon to quadtree nodes ...
Executing: /opt/google/bin/<strong>gepolygontoqtnodes</strong> --qt_nodes_file=/tmp/globe_builder/LevelFive_4282_1287494655.545115/qt_nodes.txt --kml_polygon_file=/tmp/globe_builder/LevelFive_4282_1287494655.545115/LevelFive/earth/polygon.kml 
--max_level=18
0 qtnodes Ok

Rewrite dbroot ...
Executing: /opt/google/bin/<strong>gerewritedbroot</strong>
--source=http://earth.localdomain/default_ge/ --icon_directory=/tmp/globe_builder/LevelFive_4282_1287494655.545115/LevelFive/icons --dbroot_file=/tmp/globe_builder/LevelFive_4282_1287494655.545115/dbroot.v5
--search_server=localhost
--search_port=9335
--kml_server=localhost
--kml_port=9335
--kml_map_file=/tmp/globe_builder/LevelFive_4282_1287494655.545115/kml_map.txt
8 icons
Executing: cp /tmp/globe_builder/LevelFive_4282_1287494655.545115/dbroot.v5 /tmp/globe_builder/LevelFive_4282_1287494655.545115/LevelFive/dbroot/dbroot_localhost_9335 Ok

Grab kml files ...
Executing: /opt/google/bin/<strong>gekmlgrabber</strong> --kml_map_file=/tmp/globe_builder/LevelFive_4282_1287494655.545115/kml_map.txt --output_directory=/tmp/globe_builder/LevelFive_4282_1287494655.545115/LevelFive/kml --source=http://earth.localdomain/default_ge/
--kml_server=localhost
--kml_port=9335
0 kml files Ok

Build globe ...
Executing: /opt/google/bin/<strong>geportableglobebuilder</strong>
--source=http://earth.localdomain/default_ge/
--default_level=5
--max_level=5
--hires_qt_nodes_file=/tmp/globe_builder/LevelFive_4282_1287494655.545115/qt_nodes.txt --globe_directory=/tmp/globe_builder/LevelFive_4282_1287494655.545115/LevelFive --dbroot_file=/tmp/globe_builder/LevelFive_4282_1287494655.545115/dbroot.v5 > /tmp/globe_builder/LevelFive_4282_1287494655.545115/packet_info.txt & Ok

685 image packets
128 terrain packets
515 vectors packets

Extract search data ...
Getting search poi ids:
http://earth.localdomain/cgi-bin/<strong>globe_cutter.py</strong>?cmd=POI_IDS&db=default_ge
Getting search poi data:
http://earth.localdomain/cgi-bin/<strong>globe_cutter.py</strong>?cmd=SEARCH_FILE&poi_id=&polygon=Paste%20in%20KML%20containing%20polygon.%20If%20KML%20contains%20more%20than%20one%20polygon%2C%20the%20first%20polygon%20will%20be%20used.
Saving search poi data:
/tmp/globe_builder/LevelFive_4282_1287494655.545115/LevelFive/search_db/gepoi_ Ok

Add plugin files ...
Executing: cp -r /opt/google/gehttpd/htdocs/cutter/template/earth/* /tmp/globe_builder/LevelFive_4282_1287494655.545115/LevelFive/earth
Executing: cp -r /opt/google/gehttpd/htdocs/cutter/template/maps/* /tmp/globe_builder/LevelFive_4282_1287494655.545115/LevelFive/maps
Executing: cp -r /opt/google/gehttpd/htdocs/cutter/template/js/* /tmp/globe_builder/LevelFive_4282_1287494655.545115/LevelFive/js
Rewrite JSON from: http://earth.localdomain/default_ge//query?request=Json&var=geeServerDefs Ok

Packaging globe for download ...
Executing: /opt/google/bin/<strong>geportableglobepacker</strong> --globe_directory=/tmp/globe_builder/LevelFive_4282_1287494655.545115/LevelFive --output=/opt/google/gehttpd/htdocs/cutter/globes/LevelFive.glb
Executing: chmod a+r /opt/google/gehttpd/htdocs/cutter/globes/LevelFive.glb
/opt/google/gehttpd/htdocs/cutter/globes/LevelFive.glb 9.62MB Ok

Deleting tmp directory as: /tmp/globe_builder/LevelFive_4282_1287494655.545115 Ok
</pre>

<p>This section uses the following typographic conventions: </p>
<table width="60%">
  <tr>
    <td><i>Italic</i><code> </code></td>
    <td>Information that the user must supply </td>
  </tr>
  <tr>
    <td>Square brackets <strong>[ ]</strong></td>
    <td>Optional items </td>
  </tr>
</table>

<div id="reference">
  
  <h3 id="gepolygontoqtnodes">gepolygontoqtnodes</h3>
  
  <h4>Usage</h4>
  <pre><strong>gepolygontoqtnodes</strong> --kml_polygon_file=<em>filename</em>
  --qt_nodes_file=<em>filename</em> --max_level=<em>int</em></pre>
  
  <h4>Description</h4>
  <p>Creates a list of the quadtree nodes that encompass a polygon at the given <code>max_level</code>.</p>
  
  <h4>Required</h4>
  <dl>
    <dt>--kml_polygon_file=<em>filename</em></dt>
    <dd>KML file containing a polygon that defines
    the region of interest.</dd>
    <dt>--qt_nodes_file=<em>filename</em></dt>
    <dd>File where quadtree addresses are stored.</dd>
    <dt>--max_level=<em>int</em></dt>
    <dd>Level of resolution of quadtree that is used to encompass the polygon.</dd>
    </dl>
  
  <h3 id="gerewritedbroot">gerewritedbroot  </h3>
  <h4>Usage</h4>
  <pre><strong>gerewritedbroot</strong> --source=<em>server_name</em> --icon_directory=<em>directory</em>
  --dbroot_file=<em>filename</em> [--search_server=<em>server_name</em>]
  [--search_port=<em>num]</em> [--kml_map_file=<em>filename]</em> [--kml_server=<em>server_name]</em>
  [--kml_port=<em>num]</em> [--kml_url_path=<em>prefix]</em> [--use_ssl_for_kml=<em>bool</em>]</pre>
  
  <h4>Description</h4>
  <br />
  <ul>
    <li>Reads the dbRoot and rewrites the search tabs so that they point
      at the given search server and port.</li>
    <li>Creates a directory of all of the icons referred to by the dbRoot.</li>
    <li>Creates a file listing all KML files that are referenced in the dbRoot and
      gives their new name on the KML server.</li>
  </ul>
  <h4>Required</h4>
  <dl>
    <dt>--source=<em>server_name</em></dt>
    <dd>Server whose dbRoot should be rewritten.</dd>
    <dt>--icon_directory=<em>directory</em></dt>
    <dd>Directory where the icons should be stored.</dd>
    <dt>--dbroot_file=<em>filename</em></dt>
    <dd>File where the new dbRoot should be stored.</dd>
    <dt>--kml_map_file=<em>filename</em></dt>
    <dd>File where the KML map of source URLs to local files should be stored.</dd>
    </dl>
  
  <h4>Options</h4>
  <dl>
    <dt>--search_server=<em>server_name</em></dt>
    <dd>Server to be used for search tabs in the dbRoot. Default is <code>localhost</code>.</dd>
    <dt>--search_port=<em>num</em></dt>
    <dd>Port to be used for search tabs in the dbRoot. Default is <code>8888</code>.</dd>
    <dt>--kml_server=<em>server_name</em></dt>
    <dd>Server to be used for KML files in the dbRoot. Default is <code>localhost</code>.</dd>
    <dt>--kml_port=<em>num</em></dt>
    <dd>Port to be used for KML files in the dbRoot. Default is <code>8888</code>.</dd>
    <dt>--kml_url_path=<em>prefix</em></dt>
    <dd>Path in new URL to prefix KML file name. Default is <code>kml</code>.</dd>
    <dt>--use_ssl_for_kml=<em>bool</em></dt>
    <dd>Use <code>https</code> instead of <code>http</code> for accessing KML files. Default is <code>false</code>.</dd>
  </dl>

  <h3 id="gekmlgrabber"> gekmlgrabber</h3>

  <p>gekmlgrabber --kml_map_file=/tmp/kml_map</p>

  <h4>Usage</h4>
  <pre><strong>gekmlgrabber</strong> --kml_map_file=<em>filename</em> --output_directory=<em>path</em>
  [--source=<em>server_name</em>] [--kml_server=<em>server_name</em>] [--kml_port=<em>num</em>]
  [--kml_url_path=<em>prefix]</em> [--use_ssl_for_kml=<em>bool</em>]
  [--no_recurse=<em>bool</em>] [--ignore_absolute_urls=<em>bool</em>]</pre>

  <h4>Description</h4>
  <p>Reads KML references, retrieves them from network,
    and copies them into local files. If the <code>--no_recurse</code> flag
    is not set, it does the same for any additional kml files
    referenced within the given kml files.</p>

  <h4>Required</h4>
  <dl>
    <dt>--kml_map_file=<em>filename</em></dt>
    <dd>File where map of kml source urls to local files are stored.</dd>
    <dt>--output_directory=<em>path</em></dt>
    <dd>Directory where local kml files are to be stored.</dd>
  </dl>

  <h4>Options</h4>
  <dl>
    <dt>--source=<em>server_name</em></dt>
    <dd>Source for KML files. Default is <code>localhost</code>.</dd>
    <dt>--kml_server=<em>server_name</em></dt>
    <dd>Server to be referenced in the
      dbroot for kml files.
      Default is <code>localhost</code>.</dd>
    <dt>--kml_port=<em>num</em></dt>
    <dd>Port to be referenced in the
      dbroot for kml files.
      Default is <code>9335</code>.</dd>
    <dt>--kml_url_path=<em>prefix</em></dt>
    <dd>Path in new url to prefix kml file name.
      Default is <code>kml</code>.</dd>
    <dt>--use_ssl_for_kml=<em>bool</em></dt>
    <dd>Require https:// instead of http:// for
      accessing kml files.
      Default is <code>false</code>.</dd>
    <dt>--no_recurse=<em>bool</em></dt>
    <dd>Do NOT make all kml files linked
      within the kml files local files as well.
      Default is <code>false</code>.</dd>
    <dt>--ignore_absolute_urls=<em>bool</em></dt>
    <dd>If kml is linked with a full
      url address ('<a href="http://server/...'" target="_blank">http://server/...'</a>), leave
      it as it is.
      Default is <code>false</code>.</dd>
  </dl>
  <h3 id="geportableglobebuilder">geportableglobebuilder</h3>
  <p>geportableglobebuilder --source=<a href="http://myserver" target="_blank">http://myserver</a> --max_level=18 --default_level=8 --hires_qt_nodes_file=qt_nodes.txt \<br />
    --globe_directory /tmp/my_portable_globe \</p>
  <h4>Usage</h4>
  <pre><strong>geportableglobebuilder</strong> --source=server_name --globe_directory=path
  [--max_level=num] [--default_level=num] [--hires_qt_nodes_file=filename]
  [--dbroot_file=filename] [--nowrite]</pre>
  <h4>Description</h4>
  <p>Creates a set of packet bundles and other associated files. These files can be combined into a globe file with <code>geportableglobepacker</code>.</p>
  
  <h4>Required</h4>
  <dl>
    <dt>--source=<em>server_name</em></dt>
    <dd>The source globe from which the sub-globe is to be derived.</dd>
    <dt>--globe_directory=<em>path</em></dt>
    <dd>Directory where the portable globe should be
      built.</dd>
  </dl>

  <h4>Options</h4>
  <dl>
    <dt>&nbsp;</dt>
    <dt>--max_level=<em>num</em></dt>
    <dd>Level of resolution of the quadtree above which no
      packets should be saved.
      Default is <code>24</code>.</dd>
    <dt>--default_level=<em>num</em></dt>
    <dd>Level of resolution of the quadtree for which all
      packets are kept independent of the region of interest.
      Default is <code>7</code>.</dd>
    <dt>--hires_qt_nodes_file=<em>filename</em></dt>
    <dd>Name of file containing the quadtree nodes
      that define the high-resolution area of the
      globe.
      Default is no file.</dd>
    <dt>--dbroot_file=<em>filename</em></dt>
    <dd>Name of file containing the dbRoot that should be
      saved with the globe.
      Default is no file, in which case the dbRoot is read from
      the source.</dd>
    <dt>--no_write</dt>
    <dd>Do not write packets;  print out
      the total size of the globe.</dd>
  </dl>
  <h3 id="geportableglobepacker">geportableglobepacker</h3>
  <h4>Usage</h4>
  <pre>geportableglobepacker --globe_directory=<em>path</em> --output=<em>filename</em> --make_copy=<em>bool</em></pre>
  <h4>Description</h4>
  <p>Packs up all globe files into a single file. If <code>--make_copy</code> is set
  to <code>true</code>, the globe directory is undisturbed. If not, then the
  globe directory is rendered unusable, but the command can run
  considerably faster.</p>
  <h4>Options</h4>
  <dl>
    <dt>--globe_directory=<em>path</em></dt>
    <dd>The directory containing the globes to be packed.</dd>
    <dt>--output=<em>filename</em></dt>
    <dd>The file to which to save the packed globe, including a file path if desired. The filename should use a <code>.glb</code> file extension.</dd>
    <dt>--make_copy=<em>bool</em></dt>
    <dd>Make a copy of all files so that the globe
      directory is not disturbed.
      Default is <code>false</code>.</dd>
  </dl>
  </div>
    
</div>
<!-- END PAGE CONTENT -->

</div>
<!-- END WRAPPER -->

</body>
</html>
